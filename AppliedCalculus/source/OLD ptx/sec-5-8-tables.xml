<?xml version="1.0" encoding="UTF-8" ?>
<!-- **********************************************************************-->
<!-- Copyright 2019                                                        -->
<!-- UNL Department of Mathematics                                         -->
<!-- Based upon the work of                                                -->
<!-- Matthew Boelkins                                                      -->
<!-- Copyright 2012-2018                                                   -->
<!--                                                                       -->
<!-- This file is part of Coordinated Calculus.                            -->
<!-- This file is based on Active Calculus.                                -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-SA license.  The work      -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike".  All trademarks are the registered marks of  -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-5-8-tables" permid="GxK">
  <title>Using Technology and Tables to Evaluate Integrals</title>
  <objectives permid="XvV">
    <ul permid="MWQ">

      <li permid="Fsr">
        <p permid="qjt">
          What role have integral tables historically played in the study of calculus and how can a table be used to evaluate integrals such as <m>\int \sqrt{a^2 + u^2} \, du</m>?
        </p>
      </li>

      <li permid="lzA">
        <p permid="WqC">
          What role can a computer algebra system play in the process of finding antiderivatives?
        </p>
      </li>
    </ul>
  </objectives>

  <introduction permid="DDe">
    <p permid="IWR">
      We have learned several antidifferentiation techniques:
      <m>u</m>-substitution, integration by parts, trigonometric substitution, and the method of partial fractions.
      However, there will still be cases of integrals that can not be solved by these methods. Consider the integral
      <m>\int e^{x^2} \, dx</m>: none of these methods can be used to solve this integral.
      In fact, an elementary algebraic antiderivative for <m>e^{x^2}</m> does not exist.
      No antidifferentiation method will provide us with a simple algebraic formula for a function <m>F(x)</m> that satisfies <m>F'(x) = e^{x^2}</m>. </p>
      
     <p>  The goal of this section is to recognize that there are many functions for which an algebraic formula for an antiderivative does not exist,
      and appreciate the role that computing technology can play in finding antiderivatives of other complicated functions. Moreover, tables of integrals can be helpful in finding antiderivatives quickly, even when we are able to compute them by hand.
    </p>

 

<example xml:id="PA-5-5" permid="XEz">
<statement>
  <p permid="rxq">
    For each of the indefinite integrals below, look at the table of integrals in <xref ref="integral-table">Appendix</xref>
    and decide how an antiderivative may be obtained using the table. It is also worthwhile to ask whether any of the methods we have learned so far can also be used to find an antiderivative.


    

    <ol label="a." permid="OkN">
      <li permid="urW">
        <p permid="SUG">
              <m>\int \frac{1}{1+x^2} \, dx</m>
          
        </p>
      </li>

      <li permid="azf">
        <p permid="zbP">
    
          <nbsp /> <m>\int \frac{2x+3}{1+x^2} \, dx</m>
        
        </p>
      </li>

      <li permid="GGo">
        <p permid="fiY">
          <nbsp /><m>\int \frac{e^x}{1+(e^x)^2} \, dx</m>
         
        </p>
      </li>

      <li permid="mNx">
        <p permid="Lqh">
       
          <nbsp /> <m>\int \frac{1}{\sqrt{1-x^2}} \, dx</m>
    
   
        </p>
      </li>
    </ol>
  </p>
  </statement>
   <solution>
    <p>
      <ol label="a.">
        <li>
          <p>
            This can be evaluated by following <!--<xref ref="T-4-4-Act2_2"> Table </xref>, which has antiderivatives of some basic functions.--> Rule (a) in the table. It may also be evaluated using trigonometric substitution.
          </p>
        </li>
        <li> 
          <p> 
            This requires algebraic manipulation before you can successfully use a substitution. We can evaluate <m> \int \frac{2x+3}{1+x^2} \, dx </m> by recognizing that <m> \frac{2x+3}{1+x^2} =\frac{2x}{1+x^2} + \frac{3}{1+x^2}</m> so we can split the original integral into two integrals. Then, evaluate <m> \int \frac{2x}{1+x^2} \, dx </m> with the substitution <m> u=1+x^2 \ , du=2x \, dx </m> and evaluate <m> \int \frac{3}{1+x^2} \, dx </m> by following <!--<xref ref="T-4-4-Act2_2"> Table </xref>.--> Rule (a) in the table or by using trigonometric substitution. 
            
          
          </p>  
        </li> 
        <li> 
          <p>
            This integral can be found by using the substitution <m> u=e^x \ , du=e^x \, dx </m> which transforms the integral to <m> \int \frac{1}{1+u^2} \, du </m>. The antiderivative of <m> \frac{1}{1+u^2} \, du </m> is <!--in <xref ref="T-4-4-Act2_2"> Table </xref>.--> again found using Rule (a) in the table; trigonometric substitution may also be used. 
          
            
          </p>  
        </li> 
        <li>
          <p>
         The final integral can be evaluated by following <!--<xref ref="T-4-4-Act2_2"> Table </xref>.--> Rule (g) in the table. It may also be evaluated using trigonometric substitution.
           
          </p>  
        </li>  
        </ol>

   </p>
        </solution>
        
        
  </example>
  </introduction>

     


  
  

  

  <subsection permid="SMc">
    <title>Using an Integral Table</title>
    <p permid="ZVc">
      Calculus has a long history,
      going back to Greek mathematicians in 400-300 BC. Its main foundations were first investigated and understood independently by Isaac Newton and Gottfried Wilhelm Leibniz in the late 1600s,
      making the modern ideas of calculus well over 300 years old.
      It is instructive to realize that until the late 1980s,
      the personal computer did not exist, so calculus
      (and other mathematics)
      had to be done by hand for roughly 300 years.
      In the 21st century, however,
      computers have revolutionized many aspects of the world we live in,
      including mathematics.
      In this section we take a short historical tour to precede discussing the role computer algebra systems can play in evaluating indefinite integrals.
      In particular,
      we consider a class of integrals involving certain radical expressions.
    </p>

    <p permid="Gcl">
      As seen in the short table of integrals found in <xref ref="integral-table">Appendix</xref>,
      there are many forms of integrals that involve
      <m>\sqrt{a^2 \pm w^2}</m> and <m>\sqrt{w^2 - a^2}</m>.
      These integral rules can be developed using the technique known as
      <em>trigonometric substitution</em> that we learned in the last section.
      To see how these rules are used,
      consider the differences among
      <me permid="mTo">
        \int \frac{1}{\sqrt{1-x^2}} \,dx, \ \ \  \int \frac{x}{\sqrt{1-x^2}} \,dx, \ \ \  \text{and}  \ \ \ \int \sqrt{1-x^2} \,dx
      </me>.
    </p>

    <p permid="mju">
      The first integral is a familiar basic one,
      and results in <m>\arcsin(x) + C</m>.
      The second integral can be evaluated using a standard <m>u</m>-substitution with <m>u = 1-x^2</m>.
      The third, however,
      is not familiar and does not lend itself to <m>u</m>-substitution.
    </p>

    <p permid="SqD">
      In <xref ref="integral-table">Appendix</xref>, we find the rule
      <me permid="Tax">
        \text{(h)} ~  \int \sqrt{a^2 - u^2} \, du = \frac{u}{2}\sqrt{a^2 - u^2} + \frac{a^2}{2} \arcsin \frac{u}{a} + C
      </me>.
    </p>

    <p permid="yxM">
      Using the substitutions <m>a = 1</m> and <m>u = x</m>
      (so that <m>du = dx</m>),
      it follows that
      <me permid="zhG">
        \int \sqrt{1-x^2} \, dx = \frac{x}{2} \sqrt{1-x^2} + \frac{1}{2} \arcsin x + C
      </me>.
    </p>

    <p permid="eEV">
      Whenever we are applying a rule in the table,
      we are doing a <m>u</m>-substitution,
      particularly when the substitution is more complicated than setting <m>u = x</m> as in the last example.
    </p>

    <example xml:id="ex-5-5-table-c" permid="roM">
      <statement>
        <p permid="cPI">
          Evaluate the integral
          <me permid="foP">
            \int \sqrt{9 + 64x^2} \, dx
          </me>.
        </p>
      </statement>
      <solution permid="PRw">
        <p permid="TvW">
          Here, we want to use Rule (c) from the table,
          but we now set <m>a = 3</m> and <m>u = 8x</m>.
          We also choose the <q><m>+</m></q> option in the rule.
          With this substitution,
          it follows that <m>du = 8dx</m>,
          so <m>dx = \frac{1}{8} du</m>.
          Applying the substitution,
          <me permid="LvY">
            \int \sqrt{9 + 64x^2} \, dx = \int \sqrt{9 + u^2} \cdot \frac{1}{8} \, du = \frac{1}{8} \int \sqrt{9+u^2} \, du
          </me>.
        </p>

        <p permid="zDf">
          By Rule (c), we now find that
          <md permid="rDh">
            <mrow>\int \sqrt{9 + 64x^2} \, dx =\mathstrut \amp  \frac{1}{8} \left( \frac{u}{2}\sqrt{u^2 + 9} + \frac{9}{2}\ln\left|u + \sqrt{u^2 + 9}\right| + C \right)</mrow>
            <mrow>=\mathstrut \amp  \frac{1}{8} \left( \frac{8x}{2}\sqrt{64x^2 + 9} + \frac{9}{2}\ln\left|8x + \sqrt{64x^2 + 9}\right| + C \right)</mrow>
          </md>.
        </p>
      </solution>
    </example>

    <p permid="KMe">
      Whenever we use a <m>u</m>-subsitution in conjunction with <xref ref="integral-table">Appendix</xref>, it's
      important that we not forget to address any constants that arise and include them in our computations,
      such as the <m>\frac{1}{8}</m> that appeared in <xref ref="ex-5-5-table-c">Example</xref>.
    </p>

<example xml:id="act-5-5-2" permid="OOm">
  <statement>
    <p permid="xQb">
      For each of the following integrals,
      evaluate the integral using <m>u</m>-substitution and/or an entry from the table found in <xref ref="integral-table">Appendix</xref>.

      <ol label="a."  permid="kRP">
        <li permid="QYY">
          <p permid="LjM">
            <m>\int \sqrt{x^2 + 4} \, dx</m>
          </p>
        </li>

        <li permid="xgh">
          <p permid="rqV">
            <m>\int \frac{x}{\sqrt{x^2 +4}} \, dx</m>
          </p>
        </li>

        <li permid="dnq">
          <p permid="Xye">
            <m>\int \frac{2}{\sqrt{16+25x^2}}\, dx</m>
          </p>
        </li>

        <li permid="Juz">
          <p permid="DFn">
            <m>\int \frac{1}{x^2 \sqrt{49-36x^2}} \, dx</m>
          </p>
        </li>
      </ol>
    </p>
  </statement>
  <hint permid="Mpf">
    <p permid="RIS">
      <ol label="a." permid="EKG">
        <li permid="pBI">
          <p permid="jMw">
            Compare to <m>\int \sqrt{u^2 + a^2} \, du</m>.
          </p>
        </li>

        <li permid="VIR">
          <p permid="PTF">
            Try a straightforward <m>u</m>-substitution;
            the table is unneeded.
          </p>
        </li>

        <li permid="BQa">
          <p permid="waO">
            Let <m>a = 4</m> and <m>u = 5x</m> and look for a similar integral in the table.
          </p>
        </li>

        <li permid="hXj">
          <p permid="chX">
            Let <m>a = 7</m> and <m>u = 6x</m>;
            find a related integral in the table.
          </p>
        </li>
      </ol>
    </p>
  </hint>
  <answer permid="ghW">
    <p permid="lBJ">
      <ol label="a." permid="YDx">
        <li permid="Oes">
          <p permid="Ipg">
            <m>\int \sqrt{x^2 + 4} \, dx = \frac{x}2\sqrt{x^2+4}+2\ln\big|x+\sqrt{x^2+4}\big|+C</m>.
          </p>
        </li>

        <li permid="ulB">
          <p permid="owp">
            <m>\int \frac{x}{\sqrt{x^2 +4}} \, dx = \sqrt{x^2 + 4} + C</m>.
          </p>
        </li>

        <li permid="asK">
          <p permid="UDy">
            <m>\int \frac{2}{\sqrt{16+25x^2}}\, dx = \frac{2}{5} \ln\big| 5x + \sqrt{16+25x^2} \big| + C</m>.
          </p>
        </li>

        <li permid="GzT">
          <p permid="AKH">
            <m>\int \frac{1}{x^2 \sqrt{49-36x^2}} \, dx = - \frac{\sqrt{49-36x^2}}{49x} + C</m>.
          </p>
        </li>
      </ol>
    </p>
  </answer>
  <solution permid="AaN">
    <p permid="FuA">
      <ol label="a." permid="swo">
        <li permid="mHc">
          <p permid="gRQ">
            By Rule (c) in <xref ref="integral-table">Appendix</xref>
            with <m>a=2</m> and <m>u = x</m>,
            <me permid="dXk">
              \int \sqrt{x^2 + 4} \, dx = \frac{x}2\sqrt{x^2+4}+\frac42\ln\left|x+\sqrt{x^2+4}\right|+C
            </me>.
          </p>
        </li>

        <li permid="SOl">
          <p permid="MYZ">
            Let <m>u=x^2 + 4</m>, so <m>du = 2x\, dx</m>.
            Thus
            <me permid="Ket">
              \int \frac{x}{\sqrt{x^2 +4}} \, dx = \frac{1}{2} \int \frac{du}{\sqrt{u}} = \frac{1}{2} \cdot 2u^{1/2} + C = \sqrt{x^2 + 4} + C
            </me>.
          </p>
        </li>

        <li permid="yVu">
          <p permid="tgi">
            Letting <m>a = 4</m> and <m>u = 5x</m>, we see <m>du=5\,dx</m>.
            Thus,
            <me permid="qlC">
              \int \frac{2}{\sqrt{16+25x^2}}\, dx = \frac{2}{5} \int \frac{du}{\sqrt{a^2 + u^2}}
            </me>.
            Now by Rule (b) in <xref ref="integral-table">Appendix</xref>,
            it follows
            <me permid="WsL">
              \int \frac{2}{\sqrt{16+25x^2}}\, dx = \frac{2}{5} \ln\left| 5x + \sqrt{16+25x^2} \right| + C
            </me>.
          </p>
        </li>

        <li permid="fcD">
          <p permid="Znr">
            Letting <m>a = 7</m> and <m>u = 6x</m>,
            it follows that <m>x=\frac{1}{6}u</m> and <m>du=6\,dx</m>,
            and therefore
            <me permid="CzU">
              \int \frac{1}{x^2 \sqrt{49-36x^2}} \, dx = \frac{1}{6} \int \frac{1}{\frac{1}{36}u^2 \sqrt{a^2-u^2}} \, du
            </me>.
            Using Rule (k) in <xref ref="integral-table">Appendix</xref>
            and the fact that <m>\frac{1}{6} \cdot 36 = 6</m>, we see
            <me permid="iHd">
              \int \frac{1}{x^2 \sqrt{49-36x^2}} \, dx = -6\cdot \frac{\sqrt{49-36x^2}}{49 \cdot 6x} + C
            </me>.
          </p>
        </li>
      </ol>
    </p>
  </solution>
</example>
  </subsection>

  <subsection permid="yTl">
    <title>Using Computer Algebra Systems</title>
    <p permid="qTn">
      A computer algebra system (CAS) is a computer program that is capable of executing symbolic mathematics.
      For example, if we ask a CAS to solve the equation
      <m>ax^2 + bx + c = 0</m> for the variable <m>x</m>,
      where <m>a</m>, <m>b</m>, and <m>c</m> are arbitrary constants,
      the program will return <m>x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}</m>.
      Research to develop the first CAS dates to the 1960s, and
      these programs became publicly available in the early 1990s.
      Two prominent examples are the programs
      <em>Maple</em> and <em>Mathematica</em>,
      which were among the first computer algebra systems to offer a graphical user interface.
      Today, <em>Maple</em> and <em>Mathematica</em>
      are exceptionally powerful professional software packages that can execute an amazing array of sophisticated mathematical computations.
      They are also very expensive,
      as each is a proprietary program.
      The CAS <em>SAGE</em> is an open-source,
      free alternative to <em>Maple</em>
      and <em>Mathematica</em>.
    </p>
    
    


 


    

    <p permid="Xaw">
      For the purposes of this text,
      when we need to use a CAS, we are going to turn instead to a similar,
      but somewhat different computational tool,
      the web-based <q>computational knowledge engine</q>
      called <em>WolframAlpha</em>.<fn>
      <em>WolframAlpha</em> can be accessed at <url href="https://www.wolframalpha.com/">www.wolframalpha.com</url>.</fn>
      There are two features of <em>WolframAlpha</em>
      that make it stand out from the CAS options mentioned above: (1) unlike
      <em>Maple</em> and <em>Mathematica</em>,
      <em>WolframAlpha</em> is free (provided we are willing to navigate some pop-up advertising);
      and (2) unlike any of the three,
      the syntax in <em>WolframAlpha</em> is flexible.
      Think of <em>WolframAlpha</em>
      as being a little bit like doing a Google search:
      the program will interpret what is input,
      and then provide a summary of options.
    </p>

    <p permid="DhF">
      If we want to have <em>WolframAlpha</em>
      evaluate an integral for us,
      we can provide it syntax such as
    </p>

    <blockquote permid="cfO">
      <p permid="LRx">
        <c>integrate x^2 dx</c>
      </p>
    </blockquote>

    <p permid="joO">
      to which the program responds with
      <me permid="XKq">
        \int x^2 \, dx = \frac{x^3}{3} + \text{constant}
      </me>.
    </p>

   <p>
      To find the partial fraction decomposition of any rational function,
      in <em>WolframAlpha</em>, entering
    </p>

    <blockquote permid="vYF">
      <p permid="fKo">
        <c>partial fraction 5x/(x^2-x-2)</c>
      </p>
    </blockquote>

    <p permid="NGK">
      results in the output
      <me permid="GMf">
        \frac{5x}{x^2-x-2} = \frac{10}{3(x-2)} + \frac{5}{3(x+1)}
      </me>.
    </p>



    <p permid="PvX">
      While there is much to be enthusiastic about regarding CAS programs such as <em>WolframAlpha</em>,
      there are several things we should be cautious about: (1) a CAS only responds to exactly what is input; (2) a CAS can answer using powerful functions from very advanced mathematics;
      and (3) there are problems that even a CAS cannot do without additional human insight.
    </p>

    <p permid="vDg">
      Although (1) likely goes without saying,
      we have to be careful with our input:
      if we enter syntax that defines the wrong function,
      the CAS will work with precisely the function we define.
      For example, if we are interested in evaluating the integral
      <me permid="DRz">
        \int \frac{1}{16-5x^2} \, dx
      </me>,
      and we mistakenly enter
    </p>

    <blockquote permid="ImX">
      <p permid="rYG">
        <c>integrate 1/16 - 5x^2 dx</c>
      </p>
    </blockquote>

    <p permid="bKp">
      a CAS will (correctly) reply with
      <me permid="jYI">
        \frac{1}{16}x - \frac{5}{3} x^3
      </me>.
    </p>

    <p permid="HRy">
      But if we are sufficiently well-versed in antidifferentiation,
      we will recognize that this function cannot be the one that we seek:
      integrating a rational function such as <m>\frac{1}{16-5x^2}</m>,
      we expect the logarithm function to be present in the result.
    </p>

    <p permid="nYH">
      Regarding (2), even for a relatively simple integral such as <m>\int \frac{1}{16-5x^2} \, dx</m>,
      some CASs will invoke advanced functions rather than simple ones.
      For instance, if we use <em>Maple</em> to execute the command
    </p>

    <blockquote permid="oug">
      <p permid="YfP">
        <c>int(1/(16-5*x^2), x);</c>
      </p>
    </blockquote>

    <p permid="UfQ">
      the program responds with
      <me permid="QfR">
        \int \frac{1}{16-5x^2} \, dx = \frac{\sqrt{5}}{20} \arctanh  \left(\frac{\sqrt{5}}{4}x\right)
      </me>.
    </p>

    <p permid="AmZ">
      While this is correct
      (save for the missing arbitrary constant,
      which <em>Maple</em> never reports),
      the inverse hyperbolic tangent function is not a common nor familiar one;
      a simpler way to express this function can be found by using the partial fractions method,
      and happens to be the result reported by <em>WolframAlpha</em>:
      <me permid="wna">
        \int \frac{1}{16-5x^2} \, dx = \frac{1}{8\sqrt{5}} \left(\log(4\sqrt{5}+5x) - \log(4\sqrt{5}-5x)\right) + \text{constant}
      </me>.
    </p>

    <p permid="gui">
      Using sophisticated functions from more advanced mathematics is sometimes the way a CAS says to the user
      <q>I don't know how to do this problem.</q>
      For example, if we want to evaluate
      <me permid="cuj">
        \int e^{-x^2} \, dx
      </me>,
      and we ask <em>WolframAlpha</em> to do so, the input
    </p>

    <blockquote permid="UBp">
      <p permid="EmY">
        <c>integrate exp(-x^2) dx</c>
      </p>
    </blockquote>

    <p permid="MBr">
      results in the output
      <me permid="IBs">
        \int e^{-x^2} \, dx = \frac{\sqrt{\pi}}{2}\erf  (x) + \text{constant}
      </me>.
    </p>

    <p permid="sIA">
      The function <q>erf<m>(x)</m></q>
      is the <em>error function</em>,
          <idx><h>error function</h></idx>
      which is actually defined by an integral:
      <me permid="oIB">
        \erf  (x) = \frac{2}{\sqrt{\pi}} \int_0^x e^{-t^2} \, dt
      </me>.
    </p>

    <p permid="YPJ">
      So, in producing an output involving an integral,
      the CAS has basically reported back to us the very question we asked.
    </p>

    <p permid="EWS">
      Finally, as remarked at (3) above,
      there are times that a CAS will actually fail without some additional human insight.
      If we consider the integral
      <me permid="UPK">
        \int (1+x)e^x \sqrt{1+x^2e^{2x}} \, dx
      </me>
      and ask <em>WolframAlpha</em> to evaluate
    </p>

    <blockquote permid="AIy">
      <p permid="kuh">
        <c>int (1+x) * exp(x) * sqrt(1+x^2 * exp(2x)) dx</c>,
      </p>
    </blockquote>

    <p permid="leb">
      the program thinks for a moment and then reports
    </p>

    <blockquote permid="gPH">
      <p permid="QBq">
        (<em>no result found in terms of standard mathematical functions</em>)
      </p>
    </blockquote>

    <p permid="Rlk">
      But in fact this integral is not that difficult to evaluate.
      If we let <m>u = xe^{x}</m>,
      then <m>du = (1+x)e^x \, dx</m>,
      which means that the preceding integral has the form
      <me permid="AWT">
        \int (1+x)e^x \sqrt{1+x^2e^{2x}} \, dx = \int \sqrt{1+u^2} \, du
      </me>,
      which is a straightforward one for any CAS to evaluate.
    </p>

    <p permid="xst">
      So, we should proceed with some caution:
      while any CAS is capable of evaluating a wide range of integrals
      (both definite and indefinite),
      there are times when the result can mislead us.
      We must think carefully about the meaning of the output,
      whether it is consistent with what we expect,
      and whether or not it makes sense to proceed.
    </p>
  </subsection>

  <subsection permid="fau">
    <title>Summary</title>
    <p permid="dzC">
      <ul permid="tdZ">
        
        <li permid="xNS">
          <p permid="iEU">
            Until the development of computer algebra systems,
            integral tables enabled students of calculus to evaluate integrals of certain forms quickly, such as <m>\int \sqrt{a^2 + u^2} \, du</m>,
            where <m>a</m> is a positive real number.
            A short table of integrals may be found in <xref ref="integral-table">Appendix</xref>.
          </p>
        </li>

        <li permid="dVb">
          <p permid="OMd">
            Computer algebra systems can play an important role in finding antiderivatives,
            though we must be cautious to use correct input,
            to watch for unusual or unfamiliar advanced functions that the CAS may cite in its result,
            and to consider the possibility that a CAS may need further assistance or insight from us in order to answer a particular question.
          </p>
        </li>
      </ul>
    </p>
  </subsection>

<exercises xmlns:xi="http://www.w3.org/2001/XInclude"> 

  
  <exercise permid="krq">
    <title> Using a Computer Algebra System to Antidifferentiate Rational Functions </title>
    <statement>
      <p permid="fVS">
        For each of the following integrals involving rational functions, (1) use a CAS to find the partial fraction decomposition of the integrand; (2) evaluate the integral of the resulting function without the assistance of technology; (3) use a CAS to evaluate the original integral to test and compare your result in (2).

        <ol label="a." permid="SnM">
          <li permid="KJn">
            <p permid="mQx">
              <m>\int \frac{x^3 + x + 1}{x^4 - 1} \, dx</m>
            </p>
          </li>

          <li permid="qQw">
            <p permid="SXG">
              <m>\int \frac{x^5 + x^2 + 3}{x^3 - 6x^2 + 11x - 6} \, dx</m>
            </p>
          </li>

          <li permid="WXF">
            <p permid="zeP">
              <m>\int \frac{x^2 - x - 1}{(x-3)^3} \, dx</m>
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <answer permid="IUa">
      <p permid="nAr">
        Exercise Answer
      </p>
    </answer>
    <solution permid="cMR">
      <p permid="veQ">
        <ol label="a." permid="NDT">
          <li permid="DeO">
            <p permid="flY">
              Wolfram|Alpha shows that
              <me permid="Yrt">
                \frac{x^3 + x + 1}{x^4 - 1} = -\frac{1}{2(x^2+1)} + \frac{1}{4(x+1)} + \frac{3}{4(x-1)}
              </me>.
              Then, using standard antiderivatives,
              <md permid="kFL">
                <mrow>\int \frac{x^3 + x + 1}{x^4 - 1} \, dx &amp;= \int -\frac{1}{2(x^2+1)} + \frac{1}{4(x+1)} + \frac{3}{4(x-1)} \ dx</mrow>
                <mrow>&amp;= \int -\frac{1}{2(x^2+1)} \ dx + \int \frac{1}{4(x+1)} \ dx + int \frac{3}{4(x-1)} \ dx</mrow>
                <mrow>&amp;= -\frac{1}{2} \arctan(x) + \frac{1}{4} \ln|x+1| + \frac{3}{4} \ln|x-1| + C</mrow>
              </md>
              Directly asking Wolfram|Alpha to integrate <m>\frac{x^3 + x + 1}{x^4 - 1}</m> yields
              <me permid="EyC">
                \int \frac{x^3 + x + 1}{x^4 - 1} \, dx = \frac{1}{4} \left( 3\log(1-x) + \log(x+1) - 2\arctan{x} \right) + C
              </me>.
              By rearranging, distributing the <m>\frac{1}{4}</m>,
              and noticing that Wolfram|Alpha does not use absolute value with integrals involving the logarithm
              (as well as that <m>|x-1| = |1-x|</m>),
              we see that these two results are the same.
            </p>
          </li>

          <li permid="jlX">
            <p permid="Lth">
              Wolfram|Alpha shows that
              <me permid="QMU">
                \frac{x^5 + x^2 + 3}{x^3 - 6x^2 + 11x - 6} = x^2 + 6x + 25 + \frac{255}{2(x-3)} - \frac{39}{x-2} + \frac{5}{2(x-1)}
              </me>.
              Then, using standard antiderivatives,
              <md permid="wUd">
                <mrow>\int \frac{x^5 + x^2 + 3}{x^3 - 6x^2 + 11x - 6} \, dx &amp;= \int x^2 + 6x + 25 + \frac{255}{2(x-3)} - \frac{39}{x-2} + \frac{5}{2(x-1)} \ dx</mrow>
                <mrow>&amp;= \int x^2 \ dx + \int 6x \ dx + \int 25 \ dx + \int \frac{255}{2(x-3)} \ dx - \int \frac{39}{x-2} \ dx + \int \frac{5}{2(x-1)} \ dx</mrow>
                <mrow>&amp;= \frac{x^3}{3} + 3x^2 + 25x + \frac{255}{2} \ln|x-3| - 39 \ln|x-2| + \frac{5}{2} \ln|x-1| + C</mrow>
              </md>.
              Directly asking Wolfram|Alpha to integrate
              <m>\frac{x^5 + x^2 + 3}{x^3 - 6x^2 + 11x - 6}</m> yields the same result with the caveats mentioned in part (a).
            </p>
          </li>

          <li permid="Ptg">
            <p permid="rAq">
              Wolfram|Alpha shows that
              <me permid="dbm">
                \frac{x^2 - x - 1}{(x-3)^3} = \frac{1}{x-3} + \frac{5}{(x-3)^2} + \frac{5}{(x-3)^3}
              </me>.
              Then, using standard antiderivatives,
              <md permid="VwN">
                <mrow>\int \frac{x^2 - x - 1}{(x-3)^3} \, dx &amp;= \int \frac{1}{x-3} + \frac{5}{(x-3)^2} + \frac{5}{(x-3)^3} \ dx</mrow>
                <mrow>&amp;= \int \frac{1}{x-3} \ dx + \int \frac{5}{(x-3)^2} \ dx + \int \frac{5}{(x-3)^3} \ dx</mrow>
                <mrow>&amp;= \ln|x-3| + \int 5(x-3)^{-2} \ dx + \int 5(x-3)^{-3} \ dx</mrow>
                <mrow>&amp;= \ln|x-3| - \frac{5}{x-3} - \frac{5}{2(x-3)^2} + C</mrow>
              </md>.
              Directly asking Wolfram|Alpha to integrate <m>\frac{x^2 - x - 1}{(x-3)^3}</m> yields
              <me permid="Jiv">
                \int \frac{x^2 - x - 1}{(x-3)^3} \, dx = \log(x-3) - \frac{5(2x-5)}{2(x-3)^2} + C
              </me>.
              The logarithm part is the same, and since
              <me permid="ppE">
                -\frac{5}{x-3} - \frac{5}{2(x-3)^2}  = -\frac{5[2(x-3) + 1]}{2(x-3)^2} = -\frac{5(2x-5)}{2(x-3)^2}
              </me>,
              we see that the rest of the result matches as well.
            </p>
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

  <exercise permid="Qyz">
    <title> Using a Table of Integrals to Find Antiderivatives of Radical Functions</title>
    <statement>
      <p permid="Mdb">
        For each of the following integrals involving radical functions, (1) use an appropriate <m>u</m>-substitution along with <xref ref="integral-table">Appendix</xref>
        to evaluate the integral without the assistance of technology,
        and (2) use a CAS to evaluate the original integral to test and compare your result in (1).

        <ol label="a." permid="yuV">
          <li permid="vAp">
            <p permid="XHz">
              <m>\int \frac{1}{x \sqrt{9x^2 + 25}} \, dx</m>
            </p>
          </li>

          <li permid="bHy">
            <p permid="DOI">
              <m>\int x \sqrt{1 + x^4} \, dx</m>
            </p>
          </li>

          <li permid="HOH">
            <p permid="jVR">
              <m>\int e^x \sqrt{4 + e^{2x}} \, dx</m>
            </p>
          </li>

          <li permid="nVQ">
            <p permid="Qda">
              <m>\int \frac{\tan(x)}{\sqrt{9 - \cos^2(x)}} \, dx</m>
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <answer permid="Vis">
      <p permid="THA">
        <ol label="a." permid="FZu">
          <li permid="UcZ">
            <p permid="wkj">
              <m>
              \int \frac{1}{x \sqrt{9x^2 + 25}} \, dx = -\frac{1}{5} \ln \left| \frac{5+\sqrt{9x^2 + 5^2}}{3x} \right| + C</m>.
            </p>
          </li>

          <li permid="Aki">
            <p permid="crs">
              <m>
              \int x \sqrt{1 + x^4} \, dx = \frac{1}{2} \left( \frac{x^2}{2}\sqrt{x^4 + 1} + \frac{1}{2}\ln|x^2 + \sqrt{x^4 + 1}| \right) + C
              </m>
            </p>
          </li>

          <li permid="grr">
            <p permid="IyB">
              <m>
              \int e^x \sqrt{4 + e^{2x}} \, dx = \frac{e^x}{2}\sqrt{e^{2x} + 4} + 2\ln|e^x + \sqrt{e^{2x} + 4}| + C
              </m>
            </p>
          </li>

          <li permid="MyA">
            <p permid="oFK">
              <m>
              \int \frac{\tan(x)}{\sqrt{9 - \cos^2(x)}} \, dx = \frac{1}{3} \ln \left| \frac{3 + \sqrt{9 - \cos^2(x)}}{\cos(x)} \right| + C</m>.
            </p>
          </li>
        </ol>
      </p>
    </answer>
    <solution permid="pbj">
      <p permid="blZ">
        <ol label="a." permid="tLc">
          <li permid="sFJ">
            <p permid="UMT">
              For <m>\int \frac{1}{x \sqrt{9x^2 + 25}} \, dx</m>,
              we let <m>u = 3x</m> so <m>du = 3 \, dx</m> and <m>x = \frac{1}{3} u</m>.
              Applying this substitution,
              <me permid="BDW">
                \int \frac{1}{x \sqrt{9x^2 + 25}} \, dx = \int \frac{3}{u \sqrt{u^2 + 25}} \cdot \frac{1}{3} \, du = \int \frac{1}{u \sqrt{u^2 + 25}} \, du
              </me>.
              Now, using Rule (e) from the appendix with <m>a = 5</m>,
              <me permid="hLf">
                \int \frac{1}{u \sqrt{u^2 + 25}} \, du = -\frac{1}{5} \ln \left| \frac{5+\sqrt{u^2 + 5^2}}{u} \right| + C
              </me>
              Substituting back to <m>x</m>, we've shown that
              <me permid="NSo">
                \int \frac{1}{x \sqrt{9x^2 + 25}} \, dx = -\frac{1}{5} \ln \left| \frac{5+\sqrt{9x^2 + 5^2}}{3x} \right| + C
              </me>.
              Asking Wolfram|Alpha to evaluate the same original integral,
              the program reports that
              <me permid="tZx">
                \int \frac{1}{x \sqrt{9x^2 + 25}} \, dx = \frac{1}{5} \left( \log(x) - \log\left( \sqrt{9x^2 + 25} + 5\right) \right) + C
              </me>.
              These two results are in fact the same
              (the program uses ``<m>\log</m>'' where we use ``<m>\ln</m>''),
              though it takes some work with logarithm properties to show this.
              Using the rule <m>\ln(\frac{u}{v}) = \ln (u) - \ln (v)</m> and
              <m>\ln(3x) = \ln(3) + \ln(x)</m> and including the value <m>\ln(3)</m> in the arbitrary constant of integration,
              it follows that the two results match.
            </p>
          </li>

          <li permid="YMS">
            <p permid="AUc">
              For <m>\int x \sqrt{1 + x^4} \, dx</m>,
              we first recognize that <m>x^4 = (x^2)^2</m>,
              and that with <m>u = x^2</m> we have a function-derivative pair present with <m>du = 2x \, dx</m>.
              Applying this substitution,
              <me permid="agG">
                \int x \sqrt{1 + x^4} \, dx = \int \frac{1}{2} \sqrt{1+u^2} \, du
              </me>.
              Next, we use Rule (c) with ``<m>+</m>'' and <m>a = 1</m> to find that
              <me permid="GnP">
                \int \frac{1}{2} \sqrt{1+u^2} \, du = \frac{1}{2} \left( \frac{u}{2}\sqrt{u^2 + 1} + \frac{1}{2}\ln|u + \sqrt{u^2 + 1}| \right) + C
              </me>
              Returning to the original variable, <m>x</m>, we have
              <me permid="muY">
                \int x \sqrt{1 + x^4} \, dx = \frac{1}{2} \left( \frac{x^2}{2}\sqrt{x^4 + 1} + \frac{1}{2}\ln|x^2 + \sqrt{x^4 + 1}| \right) + C
              </me>
              Wolfram|Alpha's first response when asked to evaluate this integral is to give a result that involves the hyperbolic sine function (<m>\sinh^{-1}(x^2)</m>);
              if we scroll down to ``alternate results'', we find one that matches what we've found above.
            </p>
          </li>

          <li permid="EUb">
            <p permid="hbl">
              For <m>\int e^x \sqrt{4 + e^{2x}} \, dx</m>,
              we first observe that <m>e^{2x} = (e^x)^2</m>.
              If we use the substitution <m>u = e^x</m>, the resulting integral is
              <me permid="SCh">
                \int e^x \sqrt{4 + e^{2x}} \, dx = \int \sqrt{4 + u^2} \, du
              </me>,
              which can be evaluated by the same approach as in part (b) with Rule (c) from the Appendix,
              this time with <m>a = 2</m>.
              Thus,
              <me permid="yJq">
                \int \sqrt{4 + u^2} \, du = \frac{u}{2}\sqrt{u^2 + 4} + \frac{2^2}{2}\ln|u + \sqrt{u^2 + 4}|
              </me>
              Substituting back,
              <me permid="eQz">
                \int e^x \sqrt{4 + e^{2x}} \, dx = \frac{e^x}{2}\sqrt{e^{2x} + 4} + 2\ln|e^x + \sqrt{e^{2x} + 4}|  + C
              </me>
              As in part (b),
              we need to scroll down in Wolfram|Alpha's results to find one close to what we have here.
              The alternate result almost matches, but the program writes
              <me permid="KXI">
                \log(\left( \sqrt{\frac{e^{2x}}{4} + 1 } + \frac{e^{x}}{2} \right)
              </me>
              where we have
              <me permid="reR">
                \ln|e^x + \sqrt{e^{2x} + 4}.|
              </me>
              This discrepancy can be explained using properties of the logarithm function and the presence of the arbitrary constant.
              If we write
              <me permid="Xma">
                \log(\left( \sqrt{\frac{e^{2x}}{4} + 1 } + \frac{e^{x}}{2} \right) = \log(\left( \sqrt{\frac{e^{2x} + 4}{4}} + \frac{e^{x}}{2} \right) = \log(\left( \frac{ \sqrt{e^{2x} + 4} + e^{x}}{2} \right)
              </me>
              and then recall that <m>\log \left( \frac{z}{2} \right) = \log(z) - \log(2)</m>,
              we see that the <m>\log(2)</m> can be included in the arbitray constant,
              and the two different results actually match.
            </p>
          </li>

          <li permid="lbk">
            <p permid="Niu">
              To evaluate the integral <m>\int \frac{\tan(x)}{\sqrt{9 - \cos^2(x)}} \, dx</m>,
              we first write <m>\tan(x) = \frac{\sin(x)}{\cos(x)}</m> to have the integral in the form
              <me permid="Dtj">
                \int \frac{\tan(x)}{\sqrt{9 - \cos^2(x)}} \, dx = \int \frac{\sin(x)}{\cos(x) \sqrt{9 - \cos^2(x)}} \, dx
              </me>.
              Next, letting <m>u = \cos(x)</m>,
              it follows <m>du = -\sin(x) \, dx</m>, and therefore
              <me permid="jAs">
                \int \frac{\tan(x)}{\sqrt{9 - \cos^2(x)}} \, dx = \int \frac{-1}{u \sqrt{9 - u^2}} \, du
              </me>.
              By Rule (j) in the appendix, we know that
              <me permid="PHB">
                \int \frac{1}{u \sqrt{9 - u^2}} \, du = -\frac{1}{3} \ln \left| \frac{3 + \sqrt{9 - u^2}}{u} \right| + C
              </me>.
              Connecting the above chain of equalities and substituting back to <m>x</m>,
              we have shown that
              <me permid="vOK">
                \int \frac{\tan(x)}{\sqrt{9 - \cos^2(x)}} \, dx = \frac{1}{3} \ln \left| \frac{3 + \sqrt{9 - \cos^2(x)}}{\cos(x)} \right| + C
              </me>.
              When Wolfram|Alpha is asked to evaluate the original integral,
              its first result involves the inverse hyperbolic tangent function,
              and the alternate forms are equally complicated.
              It seems that the technology is unable to evaluate this integral in the most straightforward way.
            </p>
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

  <exercise permid="wFI">
    <title> Comparing Antidifferentiation Tools </title>
    <statement>
      <p permid="skk">
        Consider the indefinite integral given by
        <me permid="bVT">
          \int \frac{\sqrt{x+\sqrt{1+x^2}}}{x} \, dx
        </me>.
        <ol label="a." permid="eCe">
          <li permid="Rit">
            <p permid="tpD">
              Explain why <m>u</m>-substitution does not offer a way to simplify this integral by discussing at least two different options you might try for <m>u</m>.
            </p>
          </li>

          <li permid="xpC">
            <p permid="ZwM">
              Explain why integration by parts does not seem to be a reasonable way to proceed, either,
              by considering one option for <m>u</m> and <m>dv</m>.
            </p>
          </li>

          <li permid="dwL">
            <p permid="FDV">
              Is there any line in the integral table in <xref ref="integral-table">Appendix</xref>
              that is helpful for this integral?
            </p>
          </li>

          <li permid="JDU">
            <p permid="lLe">
              Evaluate the given integral using <em>WolframAlpha</em>.
              What do you observe?
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <answer permid="hwK">
      <p permid="zOJ">
        <ol label="a." permid="mgD">
          <li permid="pLd">
            <p permid="RSn">
              Try <m>u = 1+x^2</m> or <m>u = x + \sqrt{1+x^2}</m>.
            </p>
          </li>

          <li permid="VSm">
            <p permid="xZw">
              Try <m>u = \sqrt{x+\sqrt{1+x^2}}</m> and <m>dv = \frac{1}{x} \, dx</m>.
            </p>
          </li>

          <li permid="BZv">
            <p permid="egF">
              No.
            </p>
          </li>

          <li permid="igE">
            <p permid="KnO">
              It appears that the function
              <m>\frac{\sqrt{x+\sqrt{1+x^2}}}{x}</m> does not have an elementary antiderivative.
            </p>
          </li>
        </ol>
      </p>
    </answer>
    <solution permid="BpB">
      <p permid="Hti">
        <ol label="a." permid="ZSl">
          <li permid="OnN">
            <p permid="quX">
              Looking at the composite functions that are present,
              there are two possible <m>u</m>-substitutions to try.
              One is <m>u = 1+x^2</m>,
              for which <m>du = 2x \, dx</m> and <m>x = \sqrt{u-1}</m>.
              Because there is no <m>x \, dx</m> term present in the integral,
              this substitution will not work.
            </p>

            <p permid="WCg">
              A second subsitution to attempt is letting <m>u = x + \sqrt{1+x^2}</m>,
              for which <m>du = \left(1 + x(1+x^2)^{-1/2} \right) \, dx</m>.
              Here, too, the needed product is not present in the integral in order for the subsitution to work.
            </p>
          </li>

          <li permid="uuW">
            <p permid="CJp">
              For integration by parts to work,
              we normally need a choice of <m>u</m> that is straightforward to differentiate,
              and <m>dv</m> that is straightforward to antidifferentiate.
              Noting that the integrand can really only be written as the product of
              <m>\frac{1}{x}</m> and <m>\sqrt{x+\sqrt{1+x^2}}</m>,
              it appears that the most natural possible option is to let
              <m>u = \sqrt{x+\sqrt{1+x^2}}</m> and <m>dv = \frac{1}{x} \, dx</m>,
              since we can antidifferentiate <m>\frac{1}{x}</m>.
              Here, however, the approach stalls,
              because integration by parts requires us to evaluate
              <m>\int v \, du</m>, and that integral is
              <me permid="Idc">
                \int \ln|x| \cdot \frac{1}{2} \left( x + \sqrt{1+x^2} \right)^{-1/2} \cdot \left( 1 + x(1+x^2)^{-1/2} \right) \, dx
              </me>
              which is far more complicated than the already-complicated integral we started with.
              From this it appears that integration by parts will not be productive.
            </p>
          </li>

          <li permid="aCf">
            <p permid="iQy">
              Since we can't seem to find a <m>u</m>-substitution that simplifies the given integral,
              and there are no formulas in the Appendix that use nested square roots,
              it appears that the table doesn't offer any help in evaluating this particular integral.
            </p>
          </li>

          <li permid="GJo">
            <p permid="OXH">
              Wolfram|Alpha returns results that either involve inverse hyperbolic trigonometric functions or complex numbers.
              As such, it appears that the function
              <m>\frac{\sqrt{x+\sqrt{1+x^2}}}{x}</m> does not have an elementary antiderivative that we can find.
            </p>
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

 </exercises>
</section>

