<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                                 -->
<!--                                                               -->
<!--    Ordinary Differential Equations Project                    -->
<!--                                                               -->
<!-- Copyright (C) 2013-2022 Thomas W. Judson                      -->
<!-- See the file COPYING for copying conditions.                  -->

<section xml:id="firstlook09" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Complex Numbers and Differential Equations</title>
    <objectives>
        <ul>

            <li><p> To understand the notation associated with complex numbers, including their Cartesian and polar/exponential forms, notations for conjugates, absolute values (also called the complex modulus), and so on.
                </p></li>

            <li><p>To understand <term>first-order differential equations</term>, such as 
                <m>\frac{dz}{dt} = f(t, z),</m> where <m>z</m> is allowed to be complex.</p></li>

            <li><p>To understand <term>Euler's identity</term> 
                <m>e^{i\theta}=\cos(\theta) + i\sin(\theta),</m>, and how to work with it in the context of differential equations.</p></li>
        </ul>
    </objectives>
    <introduction>
        <p>Recall the real numbers, denoted by <m>\mathbb{R}</m> which consist of all numbers which are positive, negative, or zero.  The real numbers include numbers such as <m>17, \sqrt{2},-5.231,\pi,e,\frac45</m>, and so on.  We define a <term>complex number</term><idx>complex number</idx> to be a "number" of the form <m>z=a+bi</m>, where <m>a</m> and <m>b</m> are real numbers, and <m>i^2=-1</m>.  Loosely speaking, we think of <m>i</m> as being equal to <m>\sqrt{-1}</m>, but its defining property is <m>i^2=-1</m>.  
Note that <m>a</m> is called the <term>real part</term> of <m>z</m>, and <m>b</m> (not <m>bi</m>) is called the <term>imaginary part</term> of <m>z</m>.  
(Note that this means that the "imaginary part" is actually a real number.) Note that evey real number <m>a</m> can be thought of as a complex number with its imaginary part equal to zero: <m>a=a+0i</m></p>
				<p>Before we too involved with the details, let's take a quick look at an example of how multiplication works:
<md>
  <mrow>(3+5i)(7+2i)&amp;=7(3+5i)+2i(3+5i)</mrow>
	<mrow>&amp;=21+35i+6i+10i^2</mrow>
	<mrow>&amp;=21+41i+10(-1)</mrow>
	<mrow>&amp;=11+41i</mrow>
</md>
Here, we simply used the distributive rule to "foil out" the binomials, used the fact that <m>i^2=-1</m>, and collected like terms.  Multiplication of complex numbers always works like this.  In general, for two complex numbers <m>z=a+bi</m> and <m>w=c+di</m>, we define their product as
 <me>zw=(a+bi)(c+di)=(ac-db) + (ad+bc)i</me>
although there is little need to memorize this formula; it is usually easier to just work it out as in the example above.
				</p>
				<p>
Addition (and subtraction) are easier: we just add (or subtract) the real parts and the imaginary parts separately:
<md>
  <mrow>z+w = (a+bi) + (c+di)&amp;=(a+c) + (b+d)i</mrow>
  <mrow>z-w = (a-bi) + (c+di)&amp;=(a-c) + (b-d)i</mrow>
</md>
Division is a little more involved.  It uses the multiplication rule, but also the high school techique of "multiplying and dividing by the conjugate".  
<md>
  <mrow>\frac{z}{w} &amp;= \frac{a+bi}{c+di}</mrow>
  <mrow>&amp;=\frac{(a+bi)(c-di)}{(c+di)(c-di)}</mrow>
  <mrow>&amp;=\frac{(ac+bd) +(bc-ad)i}{c^2+d^2}</mrow>
  <mrow>&amp;=\frac{ac+bd}{c^2+d^2} + \frac{bc-ad}{c^2+d^2}i</mrow>
</md>
To check your understand, try to show that the following is true:
<me>
  \frac{3+5i}{7+2i}=\frac{31}{53} + \frac{29}{53}i.
</me>

It turns out that the conjugate of a complex number is so special that it gets its own notation.  For a complex number of the form <m>z=a+bi</m>, where <m>a</m> and <m>b</m> are real, we denote its <term>complex conjugate</term><idx>complex conjugate</idx> by
 <me>\overline{z}=a-bi\quad\quad (\text{the complex conjugate of }z)</me>
Recall that absolute value symbol <m>|x|=\sqrt{x^2}</m> for real numbers <m>x</m>.  
One can think about <m>|x|</m> as the distance of <m>x</m> away from zero.  In the same spirit, we extend this notation to complex numbers:
<me>|z|=\sqrt{a^2+b^2}\quad\quad (\text{for }z=a+bi)</me>
This can also be thought of as the distance of <m>z</m> away from the origin <m>0+0i</m>.  The symbol <m>|z|</m> is called the 
<term>complex modulus</term><idx>complex modulus</idx>,
the <term>norm</term><idx>norm</idx>,
or simply the <term>absolute value</term><idx>absolute value</idx>.
</p>

<p>
<alert>Are complex numbers "real"?</alert>
Before we move on, it may be worth addressing a question that may be on some reader's minds: Do complex numbers "really exist" in some sense?
				This is a great question for a philosophy class, but one should also ask whether <i>any</i> numbers "really exist" (what does it mean for the number 5 to "exist"? What about the number <m>\sqrt{2}</m>).  
				Indeed, for centuries, many people doubted the existence of negative numbers (how can you have -5 apples?).  
				In fact, complex number and negative numbers gained acceptence at roughly around the same time, roughly the early to mid 1800's.  
				In modern mathematics, if we can define a self-consitent structure (that is, one that doesn't let to any internal logical contradictions), this is good enough to say that something "exists", at least in the mathematical sense.
				In any case, complex numbers, just like negative numbers, have found such an enormous number of applications in science, engineering, and mathematics (and in particular, differential equations), that it is worth learning how to use them.
</p>
</introduction>
    
    <subsection xml:id="firstlook09-subsection-complex-calc">
        <title>Complex Functions and Calculus</title>

				<p>
				The aim of this sectio nis to talk about complex differential equations.  However, first it will be useful to understand complex-valued functions of time.  These are functions whose input is a real number, and whose output is a complex number.   If we denote a complex-valued function at a time <m>t</m> by <m>z(t)</m>, we can consider its real and imaginary parts, which will themselves be functions of <m>t</m>. Let us write:
<me>
z(t) = a(t) + b(t)i
</me>
where <m>a(t)</m> and <m>b(t)</m> are real-valued functions of <m>t</m>.  Derivatives are defined in the usual way:
<me>
</me>
<md>
  <mrow>z'(t)= \frac{dz}{dt}(t) &amp;= \lim_{h\rightarrow0} \frac{z(t+h)-z(t)}{h}</mrow>
  <mrow>&amp;=\lim_{h\rightarrow0} \frac{[a(t+h)+b(t+h)i]-[a(t) + b(t)i]}{h}</mrow>
  <mrow>&amp;=\lim_{h\rightarrow0} \frac{[a(t+h)-a(t)] +ib(t+h)- b(t)]i}{h}</mrow>
  <mrow>&amp;=\lim_{h\rightarrow0} \frac{a(t+h)-a(t)}{h} +\lim_{h\rightarrow0}\frac{b(t+h)- b(t)}{h}i</mrow>
  <mrow>&amp;=a'(t) + b'(t)i</mrow>
</md>
				</p>
<p>
provided that the limits exist. 
For example:
<me>
\text{If }z(t) = t^2 + 5t^3i,\text{ then } z'(t) = 2t + 15t^2i.
</me>
Integration is defined similarly:
<me>
\int z(t)\,dt = \int (a(t)+b(t)i)\,dt = \int a(t)\,dt + i\int b(t)\,dt
</me>
</p>
<p>
We give an example with a definite integral:
<md>
  <mrow>\int_0^{\pi/2}(\sin(t)+i\cos(t))\,dt &amp;= (-\cos(t)+i\sin(t))\Big|_0^{\pi/2}</mrow>
  <mrow>&amp;= (-\cos(\tfrac{\pi}{2})+i\sin(\tfrac{\pi}{2})) - (-\cos(0)+i\sin(0))</mrow>
	<mrow>&amp;= 1+i</mrow>
</md>
</p>
It is straight-forward to verify that all of the familiar derivative and integral rules, such as the product rule, the quotient rule, the chain rule, integration by parts, u-substitution, and so on,  extend to the complex case.
    </subsection>

    <subsection xml:id="firstlook09-subsection-complex-de">
        <title>Complex Differential Equations</title>
				Now that we have defined complex derivatives and integrals, there is nothing to stop us from considering complex differential equations!
				Let us start with an example: Find a function <m>z(t)</m> satisfying:
				<me>
				\begin{cases}
				\displaystyle\frac{dz}{dt}&amp;= iz,\\
				z(0) &amp;=1.
				\end{cases}
				</me>
				Before we see a method to solve problems like this, let us first verify that the function <m>z(t)=\cos(t)+i\sin(t)</m> is a solution.  We check:
				<md>
				<mrow>\frac{dz(t)}{dt}&amp;= \frac{d}{dt}\cos(t) + i\frac{d}{dt}\sin(t)</mrow>
				<mrow>&amp;= -\sin(t) + i\cos(t)</mrow>
				<mrow>&amp;= i^2\sin(t) + i\cos(t)\quad\text{ (since $i^2=-1$)}</mrow>
				<mrow>&amp;= i(i\sin(t) + \cos(t))</mrow>
				<mrow>&amp;= iz(t)</mrow>
				</md>
and also
<me>
z(0) = \cos(0)+i\sin(0) = 1+i0 = 1.
</me>
Therefore, <m>z(t)=\cos(t)+i\sin(t)</m> is a solution to the initial value problem above.  But wait!  We already know how to solve problems like this when the coefficients are real. Consider the following initial value problem, where <m>r</m> is real:
<me>
\begin{cases}
\displaystyle\frac{dx}{dt}&amp;= rx,\\
x(0) &amp;=1.
\end{cases}
</me>
As we have already seen in earlier sections, the unique solution to this problem is given by
<me>
x(t) = e^{rt}
</me>
If we imagine that this formula extends to the complex case, we would have that the solution <m>z(t)</m> to the original problem is given by
<me>
z(t) = e^{it}
</me>
What is meant by a complex exponent? 
First of all, note that the standard existence and uniquness theorems for real-valued initial value can easily be extended to the case of complex differential equations (with the same proofs, except that we use the complex modulus <m>|z|</m> instead of the absolute value). 
Hence, we simply interpret the notation <m>e^{it}</m> to mean "<em>the</em> solution to the initial value problem <m>z'=iz,\,\,z(0)=1</m>."  One can then show that all of the usual exponent rules hold. For example, suppose that <m>z(t)</m> is the solution to <m>z'=aiz,\,\,z(0)=1</m>, and <m>w(t)</m> is the solution to <m>w'=biw,\,\,w(0)=1</m>.  Then,
<md>
<mrow>(zw)'&amp;=z'w + zw'=(aiz)w + z(biw) = (a+b)izw,</mrow>
<mrow>(zw)(0)&amp;=z(0)w(0)=1\cdot 1 = 1,</mrow>
</md>
from which it follows that <m>e^{ait}e^{bit} = e^{(a+b)it}</m>.  
We have found ourselves in a fortunte position: we have two different expressions which satisfy the same initial value problem ; namely, <m>z(t) = e^[it}</m> and <m>z(t)=\cos(t)+i\sin(t)</m>.  Therefore, by uniqueness of solutions, we have:
<me>
\fbox{
$\displaystyle e^{it}= \cos(t)+i\sin(t)$
}
</me>
This important result is called <term>Euler's identity</term>.   Euler's identity is a major key to understanding complex analysis, as we will see next.

    </subsection>

 
</section>

<!--</csection>-->
