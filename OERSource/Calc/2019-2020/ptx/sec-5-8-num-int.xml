<?xml version="1.0" encoding="UTF-8" ?>
<!-- **********************************************************************-->
<!-- Copyright 2012-2018                                                   -->
<!-- Matthew Boelkins                                                      -->
<!--                                                                       -->
<!-- This file is part of Active Calculus.                                 -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-SA license.  The work      -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike".  All trademarks are the registered marks of  -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-5-8-num-int" permid="hec">
  <title>Numerical Integration</title>
  <objectives permid="ycn">
    <ul permid="KqF">
      <li permid="WEX">
        <p permid="HvZ">
          How do we accurately evaluate a definite integral such as
          <m>\int_0^1 e^{-x^2} \, dx</m> when we cannot use the First Fundamental Theorem of Calculus because the integrand lacks an elementary algebraic antiderivative?
          Are there ways to generate accurate estimates without using extremely large values of <m>n</m> in Riemann sums?
        </p>
      </li>

      <li permid="CMg">
        <p permid="nDi">
          What is the Trapezoid Rule,
          and how is it related to left,
          right, and middle Riemann sums?
        </p>
      </li>

      <li permid="iTp">
        <p permid="TKr">
          How are the errors in the Trapezoid Rule and Midpoint Rule related,
          and how can they be used to develop an even more accurate rule?
        </p>
      </li>
    </ul>
  </objectives>

  <introduction permid="ejw">
    <p permid="snb">
      When we first explored finding the net signed area bounded by a curve,
      we developed the concept of a Riemann sum as a helpful estimation tool and a key step in the definition of the definite integral.
      Recall that the left, right,
      and middle Riemann sums of a function <m>f</m> on an interval <m>[a,b]</m> are given by
      <mdn permid="Fln">
        <mrow xml:id="E-Left">L_n = f(x_0) \Delta x + f(x_1) \Delta x + \cdots + f(x_{n-1}) \Delta x \amp= \sum_{i = 0}^{n-1} f(x_i) \Delta x,</mrow>
        <mrow xml:id="E-Right">R_n = f(x_1) \Delta x + f(x_2) \Delta x + \cdots + f(x_{n}) \Delta x \amp= \sum_{i = 1}^{n} f(x_i) \Delta x,</mrow>
        <mrow xml:id="E-Mid">M_n = f(\overline{x}_1) \Delta x + f(\overline{x}_2) \Delta x + \cdots + f(\overline{x}_{n}) \Delta x \amp= \sum_{i = 1}^{n} f(\overline{x}_i) \Delta x</mrow>
      </mdn>,
      where <m>x_0 = a</m>, <m>x_i = a + i\Delta x</m>,
      <m>x_n = b</m>, and <m>\Delta x = \frac{b-a}{n}</m>.
      For the middle sum,
      we defined <m>\overline{x}_{i} = (x_{i-1} + x_i)/2</m>.
    </p>

    <p permid="Yuk">
      A <term> Riemann sum </term> is a sum of
      (possibly signed)
      areas of rectangles.
      The value of <m>n</m> determines the number of rectangles,
      and our choice of left endpoints, right endpoints,
      or midpoints determines the heights of the rectangles.
      We can see the similarities and differences among these three options in <xref ref="F-5-6-LRMsum">Figure</xref>,
      where we consider the function
      <m>f(x) = \frac{1}{20}(x-4)^3 + 7</m> on the interval <m>[1,8]</m>,
      and use 5 rectangles for each of the Riemann sums.
    </p>

    <figure xml:id="F-5-6-LRMsum" permid="QPL">
      <caption>Left, right, and middle Riemann sums for <m>y = f(x)</m> on <m>[1,8]</m> with 5 subintervals.</caption>
      <image width="100%" source="images/5_6_LRMsum" />
    </figure>

    <p permid="EBt">
      While it is a good exercise to compute a few Riemann sums by hand,
      just to ensure that we understand how they work and how varying the function,
      the number of subintervals,
      and the choice of endpoints or midpoints affects the result,
      using computing technology is the best way to determine <m>L_n</m>,
      <m>R_n</m>, and <m>M_n</m>.
      Any computer algebra system will offer this capability.
    </p>

    <p permid="kIC">
      In this section we explore several different alternatives for estimating definite integrals.
      Our main goal is to develop formulas to estimate definite integrals accurately without using a large numbers of rectangles.
    </p>

<example xml:id="PA-5-6" permid="lIe">
  <p permid="FAV">
    As we begin to investigate ways to approximate definite integrals,
    it will be insightful to compare results to integrals whose exact values we know.
    To that end,
    the following sequence of questions centers on <m>\int_0^3 x^2 \, dx</m>.

    <ol label="a." permid="DLI">
      <li permid="jSR">
        <p permid="UJT">
          Use the applet at
          <url href="http://gvsu.edu/s/a9">http://gvsu.edu/s/a9</url>
          with the function
          <m>f(x) = x^2</m> on the window of <m>x</m> values from <m>0</m> to <m>3</m> to compute <m>L_3</m>,
          the left Riemann sum with three subintervals.
        </p>
      </li>

      <li permid="Qaa">
        <p permid="ARc">
          Likewise,
          use the applet to compute <m>R_3</m> and <m>M_3</m>,
          the right and middle Riemann sums with three subintervals,
          respectively.
        </p>
      </li>

      <li permid="whj">
        <p permid="gYl">
          Use the Fundamental Theorem of Calculus to compute the exact value of <m>I = \int_0^3 x^2 \, dx</m>.
        </p>
      </li>

      <li permid="cos">
        <p permid="Nfu">
          We define the <em>error</em>
          in an approximation of a definite integral to be the difference between the integral's exact value and the approximation's value.
          What is the error that results from using <m>L_3</m>?
          From <m>R_3</m>?
          From <m>M_3</m>?
        </p>
      </li>

      <li permid="IvB">
        <p permid="tmD">
          In what follows in this section,
          we will learn a new approach to estimating the value of a definite integral known as the Trapezoid Rule.
          The basic idea is to use trapezoids,
          rather than rectangles,
          to estimate the area under a curve.
          What is the formula for the area of a trapezoid with bases of length <m>b_1</m> and <m>b_2</m> and height <m>h</m>?
        </p>
      </li>

      <li permid="oCK">
        <p permid="ZtM">
          Working by hand, estimate the area under
          <m>f(x) = x^2</m> on <m>[0,3]</m> using three subintervals and three corresponding trapezoids.
          What is the error in this approximation?
          How does it compare to the errors you calculated in (d)?
        </p>
      </li>
    </ol>
  </p>
</example>
  </introduction>

  <subsection permid="Nll">
    <title>The Trapezoid Rule</title>
    <idx><h>trapezoid rule</h></idx>

    <p permid="wWU">
      So far, we have used the simplest possible quadrilaterals
      (that is, rectangles)
      to estimate areas.
      It is natural, however,
      to wonder if other familiar shapes might serve us even better.
    </p>

    <p permid="ded">
      An alternative to <m>L_n</m>, <m>R_n</m>,
      and <m>M_n</m> is called the <em>Trapezoid Rule</em>.
      Rather than using a rectangle to estimate the (signed) area bounded by
      <m>y = f(x)</m> on a small interval, we use a trapezoid.
      For example, in <xref ref="F-5-6-TRAP">Figure</xref>,
      we estimate the area under the curve using three subintervals and the trapezoids that result from connecting the corresponding points on the curve with straight lines.
    </p>

    <figure xml:id="F-5-6-TRAP" permid="NVf">
      <caption>Estimating <m>\int_a^b f(x) \  dx</m> using three subintervals and trapezoids, rather than rectangles, where <m>a = x_0</m> and <m>b = x_3</m>.</caption>
      <image width="73%" source="images/5_6_TRAP" />
    </figure>

    <p permid="Jlm">
      The biggest difference between the Trapezoid Rule and a Riemann sum is that on each subinterval,
      the Trapezoid Rule uses two function values, rather than one,
      to estimate the (signed) area bounded by the curve.
      For instance, to compute <m>D_1</m>,
      the area of the trapezoid on <m>[x_0, x_1]</m>,
      we observe that the left base has length <m>f(x_0)</m>,
      while the right base has length <m>f(x_1)</m>.
      The height of the trapezoid is <m>x_1 - x_0 = \Delta x = \frac{b-a}{3}</m>.
      The area of a trapezoid is the average of the bases times the height,
      so we have
      <me permid="lsw">
        D_1 = \frac{1}{2}(f(x_0) + f(x_1)) \cdot \Delta x
      </me>.
    </p>

    <p permid="psv">
      Using similar computations for <m>D_2</m> and <m>D_3</m>,
      we find that <m>T_3</m>,
      the trapezoidal approximation to <m>\int_a^b f(x) \, dx</m> is given by
      <md permid="RzF">
        <mrow>T_3 &amp;=  D_1 + D_2 + D_3</mrow>
        <mrow>&amp;= \frac{1}{2}(f(x_0) + f(x_1)) \cdot \Delta x + \frac{1}{2}(f(x_1) + f(x_2)) \cdot \Delta x + \frac{1}{2}(f(x_2) + f(x_3)) \cdot \Delta x</mrow>
      </md>.
    </p>

    <p permid="VzE">
      Because both left and right endpoints are being used,
      we recognize within the trapezoidal approximation the use of both left and right Riemann sums.
      Rearranging the expression for <m>T_3</m> by removing factors of
      <m>\frac{1}{2}</m> and <m>\Delta x </m>,
      grouping the left endpoint and right endpoint evaluations of <m>f</m>,
      we see that
      <men xml:id="E-Trap3" permid="xGO">
        T_3 =  \frac{1}{2} \left[ f(x_0) + f(x_1) + f(x_2) \right] \Delta x   +  \frac{1}{2} \left[ f(x_1) + f(x_2) + f(x_3) \right] \Delta x
      </men>.
    </p>

    <p permid="BGN">
      We now observe that two familiar sums have arisen.
      The left Riemann sum <m>L_3</m> is <m>L_3 = f(x_0) \Delta x + f(x_1) \Delta x + f(x_2) \Delta x</m>,
      and the right Riemann sum is <m>R_3 = f(x_1) \Delta x + f(x_2) \Delta x + f(x_3) \Delta x</m>.
      Substituting <m>L_3</m> and <m>R_3</m> for the corresponding expressions in <xref ref="E-Trap3">Equation</xref>,
      it follows that <m>T_3 = \frac{1}{2} \left[ L_3 + R_3 \right]</m>.
      We have thus seen a very important result:
      using trapezoids to estimate the (signed) area bounded by a curve is the same as averaging the estimates generated by using left and right endpoints.
    </p>

    <assemblage permid="RVe">
      <title>The Trapezoid Rule</title>
      <p permid="hNW">
        The trapezoidal approximation, <m>T_n</m>,
        of the definite integral <m>\int_a^b f(x) \, dx</m> using <m>n</m> subintervals is given by the rule
        <md permid="dNX">
          <mrow>T_n =\mathstrut \amp  \left[\frac{1}{2}(f(x_0) + f(x_1)) + \frac{1}{2}(f(x_1) + f(x_2))  + \cdots + \frac{1}{2}(f(x_{n-1}) + f(x_n)) \right] \Delta x.</mrow>
          <mrow>=\mathstrut \amp  \sum_{i=0}^{n-1} \frac{1}{2}(f(x_i) + f(x_{i+1}))  \Delta x</mrow>
        </md>.
        Moreover, <m>T_n = \frac{1}{2} \left[ L_n + R_n \right]</m>.
      </p>
    </assemblage>

<example xml:id="act-5-6-1" permid="fqY">
  <statement>
    <p permid="pQd">
      In this example,
      we explore the relationships among the errors generated by left, right,
      midpoint,
      and trapezoid approximations to the definite integral <m>\int_1^2 \frac{1}{x^2} \, dx</m>

      <ol label="a." permid="fMx">
        <li permid="LTG">
          <p permid="eHe">
            Use the First FTC to evaluate <m>\int_1^2 \frac{1}{x^2} \, dx</m> exactly.
          </p>
        </li>

        <li permid="saP">
          <p permid="KOn">
            Use appropriate computing technology to compute the following approximations for <m>\int_1^2 \frac{1}{x^2} \, dx</m>:
            <m>T_4</m>, <m>M_4</m>,
            <m>T_8</m>, and <m>M_8</m>.
          </p>
        </li>

        <li permid="YhY">
          <p permid="qVw">
            Let the <em>error</em>
              <idx><h>error</h></idx>
              <idx><h>trapezoid rule</h><h>error</h></idx>
              <idx><h>midpoint rule</h><h>error</h></idx>
            of an approximation be the difference between the exact value of the definite integral and the resulting approximation.
            For instance,
            if we let <m>E_{T,4}</m> represent the error that results from using the trapezoid rule with 4 subintervals to estimate the integral, we have
            <me permid="VXm">
              E_{T,4} = \int_1^2 \frac{1}{x^2} \, dx -  T_4
            </me>.
            Similarly,
            we compute the error of the midpoint rule approximation with 8 subintervals by the formula
            <me permid="Cev">
              E_{M,8} = \int_1^2 \frac{1}{x^2} \, dx -  M_8
            </me>.
            Based on your work in (a) and (b) above,
            compute <m>E_{T,4}</m>, <m>E_{T,8}</m>,
            <m>E_{M,4}</m>, <m>E_{M,8}</m>.
          </p>
        </li>

        <li permid="Eph">
          <p permid="XcF">
            Which rule consistently over-estimates the exact value of the definite integral?
            Which rule consistently under-estimates the definite integral?
          </p>
        </li>

        <li permid="kwq">
          <p permid="DjO">
            What behavior(s) of the function
            <m>f(x) = \frac{1}{x^2}</m> lead to your observations in (d)?
          </p>
        </li>
      </ol>
    </p>
  </statement>
  <hint permid="HjN">
    <p permid="JIU">
      <ol label="a." permid="zFo">
        <li permid="QDz">
          <p permid="jqX">
            <m>\frac{1}{x^2} = x^{-2}</m>.
          </p>
        </li>

        <li permid="wKI">
          <p permid="Pyg">
            Use a computational device.
          </p>
        </li>

        <li permid="cRR">
          <p permid="vFp">
            Use a computational device.
          </p>
        </li>

        <li permid="IZa">
          <p permid="bMy">
            Which estimate is larger than the true value of the definite integral?
          </p>
        </li>

        <li permid="pgj">
          <p permid="HTH">
            Note that how the curve bends makes a big difference in whether the trapezoid rule over- or under-estimates the value of the definite integral.
          </p>
        </li>
      </ol>
    </p>
  </hint>
  <answer permid="bcE">
    <p permid="dBL">
      <ol label="a." permid="Tyf">
        <li permid="Vns">
          <p permid="oaQ">
            <m>\int_1^2 \dfrac{1}{x^2} dx = \dfrac{1}{2}</m>.
          </p>
        </li>

        <li permid="BuB">
          <p permid="UhZ">
            The table below gives values of the trapezoid rule and corresponding errors for different <m>n</m>-values.
          </p>

          <sidebyside permid="GOo">

            <tabular top="minor" bottom="minor" permid="ilE">
              <row bottom="medium">
                <cell><m>n</m></cell>
                <cell><m>T_n</m></cell>
                <cell><m>E_{T,n}</m></cell>
              </row>
              <row>
                <cell><m>4</m></cell>
                <cell><m>0.50899</m></cell>
                <cell><m>-0.50899</m></cell>
              </row>
              <row>
                <cell><m>8</m></cell>
                <cell><m>0.50227</m></cell>
                <cell><m>-0.50227</m></cell>
              </row>
              <row>
                <cell><m>16</m></cell>
                <cell><m>0.50057</m></cell>
                <cell><m>-0.50057</m></cell>
              </row>
            </tabular>

          </sidebyside>

        </li>

        <li permid="hBK">
          <p permid="Api">
            The table below gives values of the midpoint rule and corresponding errors for different <m>n</m>-values.
          </p>

          <sidebyside permid="mVx">

            <tabular top="minor" bottom="minor" permid="OsN">
              <row bottom="medium">
                <cell><m>n</m></cell>
                <cell><m>M_n</m></cell>
                <cell><m>E_{M,n}</m></cell>
              </row>
              <row>
                <cell><m>4</m></cell>
                <cell><m>0.49555</m></cell>
                <cell><m>0.00445</m></cell>
              </row>
              <row>
                <cell><m>8</m></cell>
                <cell><m>0.49887</m></cell>
                <cell><m>0.00113</m></cell>
              </row>
              <row>
                <cell><m>16</m></cell>
                <cell><m>0.49972</m></cell>
                <cell><m>0.00028</m></cell>
              </row>
            </tabular>

          </sidebyside>

        </li>

        <li permid="NIT">
          <p permid="gwr">
            The trapezoid rule overestimates;
            the midpoint rule underestimates.
          </p>
        </li>

        <li permid="tQc">
          <p permid="MDA">
            <m>f(x) = \dfrac{1}{x^2}</m> is concave up on <m>[1, 2]</m>.
          </p>
        </li>
      </ol>
    </p>
  </answer>
  <solution permid="uVv">
    <p permid="xuC">
      <ol label="a." permid="nqW">
        <li permid="ZXl">
          <p permid="sKJ">
            <m>\int_1^2 \dfrac{1}{x^2} dx = \left. -x^{-1} \right|_1^2 = -\dfrac{1}{2} + 1 = \dfrac{1}{2}</m>.
          </p>
        </li>

        <li permid="Geu">
          <p permid="YRS">
            The table below gives values of the trapezoid rule and corresponding errors for different <m>n</m>-values.
          </p>

          <sidebyside permid="TcG">

            <tabular top="minor" bottom="minor" permid="uzW">
              <row bottom="medium">
                <cell><m>n</m></cell>
                <cell><m>T_n</m></cell>
                <cell><m>E_{T,n}</m></cell>
              </row>
              <row>
                <cell><m>4</m></cell>
                <cell><m>0.50899</m></cell>
                <cell><m>-0.50899</m></cell>
              </row>
              <row>
                <cell><m>8</m></cell>
                <cell><m>0.50227</m></cell>
                <cell><m>-0.50227</m></cell>
              </row>
              <row>
                <cell><m>16</m></cell>
                <cell><m>0.50057</m></cell>
                <cell><m>-0.50057</m></cell>
              </row>
            </tabular>

          </sidebyside>

        </li>

        <li permid="mlD">
          <p permid="EZb">
            The table below gives values of the midpoint rule and corresponding errors for different <m>n</m>-values.
          </p>

          <sidebyside permid="zjP">

            <tabular top="minor" bottom="minor" permid="aHf">
              <row bottom="medium">
                <cell><m>n</m></cell>
                <cell><m>M_n</m></cell>
                <cell><m>E_{M,n}</m></cell>
              </row>
              <row>
                <cell><m>4</m></cell>
                <cell><m>0.49555</m></cell>
                <cell><m>0.00445</m></cell>
              </row>
              <row>
                <cell><m>8</m></cell>
                <cell><m>0.49887</m></cell>
                <cell><m>0.00113</m></cell>
              </row>
              <row>
                <cell><m>16</m></cell>
                <cell><m>0.49972</m></cell>
                <cell><m>0.00028</m></cell>
              </row>
            </tabular>

          </sidebyside>

        </li>

        <li permid="SsM">
          <p permid="lgk">
            From the errors in comparision to the known exact value,
            we see that the trapezoid rule overestimates this definite integral and the midpoint rule underestimates this definite integral.
          </p>
        </li>

        <li permid="yzV">
          <p permid="Rnt">
            The graph of the function given by
            <m>f(x) = \dfrac{1}{x^2}</m> is concave up on the interval <m>[1, 2]</m>.
            Because of this fact,
            we can see graphically that the line forming the top of each trapezoid lies fully above the curve,
            and thus the trapezoid rule overestimates the true value of the definite integral.
            Later in this section we'll see graphically why this concavity makes the midpoint rule an underestimate.
          </p>
        </li>
      </ol>
    </p>
  </solution>
</example>
  </subsection>

  <subsection permid="tsu">
    <title>Comparing the Midpoint and Trapezoid Rules</title>
    <p permid="uco">
      We know from the definition of the definite integral
      that if we let <m>n</m> be large enough,
      we can make any of the approximations <m>L_n</m>,
      <m>R_n</m>,
      and <m>M_n</m> as close as we'd like
      (in theory)
      to the exact value of <m>\int_a^b f(x) \, dx</m>.
      Thus, it may be natural to wonder why we ever use any rule other than <m>L_n</m> or <m>R_n</m>
      (with a sufficiently large <m>n</m> value)
      to estimate a definite integral.
      One of the primary reasons is that as <m>n \to \infty</m>,
      <m>\Delta x = \frac{b-a}{n} \to 0</m>,
      and thus in a Riemann sum calculation with a large <m>n</m> value,
      we end up multiplying by a number that is very close to zero.
      Doing so often generates roundoff error,
      because representing numbers close to zero accurately is a persistent challenge for computers.
    </p>

    <p permid="ajx">
      Hence, we explore ways to estimate definite integrals to high levels of precision,
      but without using extremely large values of <m>n</m>.
      Paying close attention to patterns in errors,
      such as those observed in <xref ref="act-5-6-1">Example</xref>,
      is one way to begin to see some alternate approaches.
    </p>

    <p permid="GqG">
      To begin, we compare the errors in the Midpoint and Trapezoid rules.
      First, consider a function that is concave up on a given interval,
      and picture approximating the area bounded on that interval by both the Midpoint and Trapezoid rules using a single subinterval.
    </p>

    <figure xml:id="F-5-6-MidVTrap" permid="jDj">
      <caption>Estimating <m>\int_a^b f(x) \  dx</m> using a single subinterval: at left, the trapezoid rule; in the middle, the midpoint rule; at right, a modified way to think about the midpoint rule.</caption>
      <image width="100%" source="images/5_6_MidVTrap" />
    </figure>

    <p permid="mxP">
      As seen in <xref ref="F-5-6-MidVTrap">Figure</xref>,
      it is evident that whenever the function is concave up on an interval,
      the Trapezoid Rule with one subinterval, <m>T_1</m>,
      will overestimate the exact value of the definite integral on that interval.
      From a careful analysis of the line that bounds the top of the rectangle for the Midpoint Rule
      (shown in magenta),
      we see that if we rotate this line segment until it is tangent to the curve at the midpoint of the interval
      (as shown at right in <xref ref="F-5-6-MidVTrap">Figure</xref>),
      the resulting trapezoid has the same area as <m>M_1</m>,
      and this value is less than the exact value of the definite integral.
      Thus, when the function is concave up on the interval,
      <m>M_1</m> underestimates the integral's true value.
    </p>

    <figure xml:id="F-5-6-MidTrapError" permid="PKs">
      <caption>Comparing the error in estimating <m>\int_a^b f(x) \  dx</m> using a single subinterval: in red, the error from the Trapezoid rule; in light red, the error from the Midpoint rule.</caption>
      <image width="47%" source="images/5_6_MidTrapError" />
    </figure>

    <p permid="SEY">
      These observations extend easily to the situation where the function's concavity remains consistent but we use larger values of <m>n</m> in the Midpoint and Trapezoid Rules.
      Hence, whenever <m>f</m> is concave up on <m>[a,b]</m>,
      <m>T_n</m> will overestimate the value of <m>\int_a^b f(x) \, dx</m>,
      while <m>M_n</m> will underestimate <m>\int_a^b f(x) \, dx</m>.
      The reverse observations are true in the situation where <m>f</m> is concave down.
    </p>

    <p permid="yMh">
      Next, we compare the size of the errors between <m>M_n</m> and <m>T_n</m>.
      Again, we focus on <m>M_1</m> and <m>T_1</m> on an interval where the concavity of <m>f</m> is consistent.
      In <xref ref="F-5-6-MidTrapError">Figure</xref>,
      where the error of the Trapezoid Rule is shaded in red,
      while the error of the Midpoint Rule is shaded lighter red,
      it is visually apparent that the error in the Trapezoid Rule is more significant.
      To see how much more significant,
      let's consider two examples and some particular computations.
    </p>

    <p permid="eTq">
      If we let <m>f(x) = 1-x^2</m> and consider <m>\int_0^1 f(x) \,dx</m>,
      we know by the First FTC that the exact value of the integral is
      <me permid="JVg">
        \int_0^1 (1-x^2) \, dx = x - \frac{x^3}{3} \bigg\vert_0^1 = \frac{2}{3}
      </me>.
    </p>

    <p permid="Laz">
      Using appropriate technology to compute <m>M_4</m>,
      <m>M_8</m>, <m>T_4</m>, and <m>T_8</m>,
      as well as the corresponding errors <m>E_{M,4}</m>, <m>E_{M,8}</m>,
      <m>E_{T,4}</m>, and <m>E_{T,8}</m>,
      as we did in <xref ref="act-5-6-1">Example</xref>,
      we find the results summarized in <xref ref="T-5-6-Ex2">Table</xref>.
      We also include the approximations and their errors for the example
      <m>\int_1^2 \frac{1}{x^2} \, dx</m> from <xref ref="act-5-6-1">Example</xref>.
    </p>

    <table xml:id="T-5-6-Ex2" permid="ixQ">
      <caption>Calculations of <m>T_4</m>, <m>M_4</m>, <m>T_8</m>, and <m>M_8</m>, along with corresponding errors, for the definite integrals <m>\int_0^1 (1-x^2) \  dx</m> and <m>\int_1^2 \frac{1}{x^2} \  dx</m>.</caption>
      <tabular top="minor" bottom="minor" permid="OEZ">
        <row>
          <cell>Rule</cell>
          <cell><m>\int_0^1 (1-x^2) \,dx = 0.\overline{6}</m></cell>
          <cell>error</cell>
          <cell><m>\int_1^2 \frac{1}{x^2} \, dx = 0.5</m></cell>
          <cell>error</cell>
        </row>
        <row>
          <cell><m>T_4</m></cell>
          <cell><m>0.65625</m></cell>
          <cell><m>-0.0104166667</m></cell>
          <cell><m>0.5089937642</m></cell>
          <cell><m>0.0089937642</m></cell>
        </row>
        <row>
          <cell><m>M_4</m></cell>
          <cell><m>0.671875</m></cell>
          <cell><m>0.0052083333</m></cell>
          <cell><m>0.4955479365</m></cell>
          <cell><m>-0.0044520635</m></cell>
        </row>
        <row>
          <cell><m>T_8</m></cell>
          <cell><m>0.6640625</m></cell>
          <cell><m>-0.0026041667</m></cell>
          <cell><m>0.5022708502</m></cell>
          <cell><m>0.0022708502</m></cell>
        </row>
        <row>
          <cell><m>M_8</m></cell>
          <cell><m>0.66796875</m></cell>
          <cell><m>0.0013020833</m></cell>
          <cell><m>0.4988674899</m></cell>
          <cell><m>-0.0011325101</m></cell>
        </row>
      </tabular>

    </table>

    <p permid="rhI">
      For a given function <m>f</m> and interval <m>[a,b]</m>,
      <m>E_{T,4} = \int_a^b f(x) \,dx - T_4</m> calculates the difference between the exact value of the definite integral and the approximation generated by the Trapezoid Rule with <m>n = 4</m>.
      If we look at not only <m>E_{T,4}</m>,
      but also the other errors generated by using <m>T_n</m> and <m>M_n</m> with <m>n = 4</m> and <m>n = 8</m> in the two examples noted in <xref ref="T-5-6-Ex2">Table</xref>,
      we see an evident pattern.
      Not only is the sign of the error
      (which measures whether the rule generates an over- or under-estimate)
      tied to the rule used and the function's concavity,
      but the magnitude of the errors generated by <m>T_n</m> and <m>M_n</m> seems closely connected.
      In particular,
      the errors generated by the Midpoint Rule seem to be about half the size of those generated by the Trapezoid Rule.
    </p>

    <p permid="XoR">
      That is, we can observe in both examples that
      <m>E_{M,4} \approx -\frac{1}{2} E_{T,4}</m> and <m>E_{M,8} \approx -\frac{1}{2}E_{T,8}</m>.
      This property of the Midpoint and Trapezoid Rules turns out to hold in general:
      for a function of consistent concavity,
      the error in the Midpoint Rule has the opposite sign and approximately half the magnitude of the error of the Trapezoid Rule.
      Written symbolically,
      <me permid="qcp">
        E_{M,n} \approx -\frac{1}{2} E_{T,n}
      </me>.
    </p>

    <p permid="Dwa">
      This important relationship suggests a way to combine the Midpoint and Trapezoid Rules to create an even more accurate approximation to a definite integral.
    </p>
  </subsection>

  <subsection permid="ZzD">
    <title>Simpson's Rule</title>
    <idx><h>Simpson's rule</h></idx>

    <p permid="vRB">
      When we first developed the Trapezoid Rule,
      we observed that it is an average of the Left and Right Riemann sums:
      <me permid="Wjy">
        T_n = \frac{1}{2}(L_n + R_n)
      </me>.
    </p>

    <p permid="bYK">
      If a function is always increasing or always decreasing on the interval <m>[a,b]</m>,
      one of <m>L_n</m> and <m>R_n</m> will over-estimate the true value of <m>\int_a^b f(x) \, dx</m>,
      while the other will under-estimate the integral.
      Thus,
      the errors found in <m>L_n</m> and <m>R_n</m> will have opposite signs;
      so averaging <m>L_n</m> and <m>R_n</m> eliminates a considerable amount of the error present in the respective approximations.
      In a similar way,
      it makes sense to think about averaging <m>M_n</m> and <m>T_n</m> in order to generate a still more accurate approximation.
    </p>

    <p permid="IfT">
      We've just observed that <m>M_n</m> is typically about twice as accurate as <m>T_n</m>.
      So we use the weighted average
          <idx><h>weighted average</h></idx>
      <men xml:id="E-Simpson" permid="CqH">
        S_{2n} = \frac{2M_n + T_n}{3}
      </men>.
    </p>

    <p permid="onc">
      The rule for <m>S_{2n}</m> giving by <xref ref="E-Simpson">Equation</xref>
      is usually known as <term>Simpson's Rule</term>.<fn>
      Thomas Simpson was an 18th century mathematician;
      his idea was to extend the Trapezoid rule,
      but rather than using straight lines to build trapezoids,
      to use quadratic functions to build regions whose area was bounded by parabolas
      (whose areas he could find exactly).
      Simpson's Rule is often developed from the more sophisticated perspective of using interpolation by quadratic functions.
      </fn> Note that we use
      <q><m>S_{2n}</m></q> rather that <q><m>S_n</m></q>
      since the <m>n</m> points the Midpoint Rule uses are different from the <m>n</m> points the Trapezoid Rule uses,
      and thus Simpson's Rule is using <m>2n</m> points at which to evaluate the function.
      We build upon the results in <xref ref="T-5-6-Ex2">Table</xref>
      to see the approximations generated by Simpson's Rule.
      In particular, in <xref ref="T-5-6-Ex3">Table</xref>,
      we include all of the results in <xref ref="T-5-6-Ex2">Table</xref>,
      but include additional results for
      <m>S_8 = \frac{2M_4 + T_4}{3}</m> and <m>S_{16} = \frac{2M_8 + T_8}{3}</m>.
    </p>

    <table xml:id="T-5-6-Ex3" permid="uMi">
      <caption><xref ref="T-5-6-Ex2">Table</xref> updated to include <m>S_8</m>, <m>S_{16}</m>, and the corresponding errors.</caption>
      <tabular top="minor" bottom="minor" permid="aTr">
        <row>
          <cell>Rule</cell>
          <cell><m>\int_0^1 (1-x^2) \,dx = 0.\overline{6}</m></cell>
          <cell>error</cell>
          <cell><m>\int_1^2 \frac{1}{x^2} \, dx = 0.5</m></cell>
          <cell>error</cell>
        </row>
        <row>
          <cell><m>T_4</m></cell>
          <cell><m>0.65625</m></cell>
          <cell><m>-0.0104166667</m></cell>
          <cell><m>0.5089937642</m></cell>
          <cell><m>0.0089937642</m></cell>
        </row>
        <row>
          <cell><m>M_4</m></cell>
          <cell><m>0.671875</m></cell>
          <cell><m>0.0052083333</m></cell>
          <cell><m>0.4955479365</m></cell>
          <cell><m>-0.0044520635</m></cell>
        </row>
        <row>
          <cell><m>S_8</m></cell>
          <cell><m>0.6666666667</m></cell>
          <cell><m>0</m></cell>
          <cell><m>0.5000298792</m></cell>
          <cell><m>0.0000298792</m></cell>
        </row>
        <row>
          <cell><m>T_8</m></cell>
          <cell><m>0.6640625</m></cell>
          <cell><m>-0.0026041667</m></cell>
          <cell><m>0.5022708502</m></cell>
          <cell><m>0.0022708502</m></cell>
        </row>
        <row>
          <cell><m>M_8</m></cell>
          <cell><m>0.66796875</m></cell>
          <cell><m>0.0013020833</m></cell>
          <cell><m>0.4988674899</m></cell>
          <cell><m>-0.0011325101</m></cell>
        </row>
        <row>
          <cell><m>S_{16}</m></cell>
          <cell><m>0.6666666667</m></cell>
          <cell><m>0</m></cell>
          <cell><m>0.5000019434</m></cell>
          <cell><m>0.0000019434</m></cell>
        </row>
      </tabular>

    </table>

    <p permid="Uul">
      The results seen in <xref ref="T-5-6-Ex3">Table</xref> are striking.
      If we consider the <m>S_{16}</m> approximation of <m>\int_1^2 \frac{1}{x^2} \, dx</m>,
      the error is only <m>E_{S,16} = 0.0000019434</m>.
      By contrast, <m>L_8 = 0.5491458502</m>,
      so the error of that estimate is <m>E_{L,8} = -0.0491458502</m>.
      Moreover, we observe that generating the approximations for Simpson's Rule is almost no additional work:
      once we have <m>L_n</m>,
      <m>R_n</m>, and <m>M_n</m> for a given value of <m>n</m>,
      it is a simple exercise to generate <m>T_n</m>,
      and from there to calculate <m>S_{2n}</m>.
      Finally, note that the error in the Simpson's Rule approximations of
      <m>\int_0^1 (1-x^2) \, dx</m> is zero!<fn>
      Similar to how the Midpoint and Trapezoid approximations are exact for linear functions, Simpson's Rule approximations are exact for quadratic and cubic functions.
      See additional discussion on this issue later in the section and in the exercises.
      </fn></p>

    <p permid="ABu">
      These rules are not only useful for approximating definite integrals such as <m>\int_0^1 e^{-x^2} \, dx</m>,
      for which we cannot find an elementary antiderivative of <m>e^{-x^2}</m>,
      but also for approximating definite integrals when we are given a function through a table of data.
    </p>

<example xml:id="act-5-6-2" permid="sZe">
  <statement>
    <p permid="jFs">
      A car traveling along a straight road is braking and its velocity is measured at several different points in time,
      as given in the following table.
      Assume that <m>v</m> is continuous, always decreasing,
      and always decreasing at a decreasing rate,
      as is suggested by the data.
    </p>

    <sidebyside widths="47% 47%" valign="middle" permid="MRV">

      <table permid="ADD">
        <caption>Data for the braking car.</caption>
        <tabular halign="center" permid="gKM">
          <row bottom="minor">
            <cell>seconds, <m>t</m></cell>
            <cell>Velocity in ft/sec, <m>v(t)</m></cell>
          </row>
          <row>
            <cell><m>0</m></cell>
            <cell><m>100</m></cell>
          </row>
          <row>
            <cell><m>0.3</m></cell>
            <cell><m>99</m></cell>
          </row>
          <row>
            <cell><m>0.6</m></cell>
            <cell><m>96</m></cell>
          </row>
          <row>
            <cell><m>0.9</m></cell>
            <cell><m>90</m></cell>
          </row>
          <row>
            <cell><m>1.2</m></cell>
            <cell><m>80</m></cell>
          </row>
          <row>
            <cell><m>1.5</m></cell>
            <cell><m>50</m></cell>
          </row>
          <row>
            <cell><m>1.8</m></cell>
            <cell><m>0</m></cell>
          </row>
        </tabular>

      </table>

      <figure xml:id="F-5-6-Act2" permid="Dyj">
        <caption>Axes for plotting the data in <xref ref="act-5-6-2">Example</xref>.</caption>
        <image source="images/5_6_Act2" />
      </figure>
    </sidebyside>

    <p permid="PMB">
      <ol label="a." permid="wpj">
        <li permid="cws">
          <p permid="TMA">
            Plot the given data on the set of axes provided in <xref ref="F-5-6-Act2">Figure</xref>
            with time on the horizontal axis and the velocity on the vertical axis.
          </p>
        </li>

        <li permid="IDB">
          <p permid="zTJ">
            What definite integral will give you the exact distance the car traveled on <m>[0,1.8]</m>?
          </p>
        </li>

        <li permid="oKK">
          <p permid="gaS">
            Estimate the total distance traveled on <m>[0,1.8]</m> by computing <m>L_3</m>,
            <m>R_3</m>, and <m>T_3</m>.
            Which of these under-estimates the true distance traveled?
          </p>
        </li>

        <li permid="URT">
          <p permid="Mib">
            Estimate the total distance traveled on <m>[0,1.8]</m> by computing <m>M_3</m>.
            Is this an over- or under-estimate?
            Why?
          </p>
        </li>

        <li permid="AZc">
          <p permid="spk">
            Using your results from (c) and (d),
            improve your estimate further by using Simpson's Rule.
          </p>
        </li>

        <li permid="hgl">
          <p permid="Ywt">
            What is your best estimate of the average velocity of the car on <m>[0,1.8]</m>?
            Why?
            What are the units on this quantity?
          </p>
        </li>
      </ol>
    </p>
  </statement>
  <hint permid="XMz">
    <p permid="Xra">
      <ol label="a." permid="Qia">
        <li permid="Nnu">
          <p permid="EDC">
            Plot the data.
          </p>
        </li>

        <li permid="tuD">
          <p permid="kKL">
            What are the units of <m>v(t) \cdot \Delta t</m>?
          </p>
        </li>

        <li permid="ZBM">
          <p permid="QRU">
            Recall the standard rules for sums that produce <m>L_3</m>,
            <m>R_3</m>,
            <m>T_3</m>.
          </p>
        </li>

        <li permid="FIV">
          <p permid="wZd">
            Think about concavity to decide if <m>M_3</m> is an over- or under-estimate.
          </p>
        </li>

        <li permid="lQe">
          <p permid="dgm">
            Recall how <m>S_3</m> is a weighted average of <m>T_3</m> and <m>M_3</m>.
          </p>
        </li>

        <li permid="RXn">
          <p permid="Jnv">
            Simpson's Rule gives the best estimate for a function of consistent concavity.
          </p>
        </li>
      </ol>
    </p>
  </hint>
  <answer permid="rFq">
    <p permid="rjR">
      <ol label="a." permid="kaR">
        <li permid="yew">
          <p permid="puE">
            Plot the data.
          </p>
        </li>

        <li permid="elF">
          <p permid="VBN">
            <m> \int_0^{1.8} v(t) dt</m>.
          </p>
        </li>

        <li permid="KsO">
          <p permid="BIW">
            <md permid="vTK">
              <mrow>L_3 \amp = 165.6 \text{ ft }  \amp  R_3 \amp = 105.6 \text{ ft }  \amp  T_3 \amp = 135.6 \text{ ft }</mrow>
            </md>.
            <m>R_3</m> and <m>T_3</m> are underestimates.
          </p>
        </li>

        <li permid="qzX">
          <p permid="hQf">
            <m> M_3 = 143.4 \text{ ft } </m> ; overestimate.
          </p>
        </li>

        <li permid="WHg">
          <p permid="NXo">
            <m> S_6 = 140.8 \text{ ft } </m>.
          </p>
        </li>

        <li permid="COp">
          <p permid="uex">
            Simpson's rule gives the best approximation of the distance traveled,
            <m>\int_0^{1.8} v(t) dt \approx 140.8 \text{ ft }</m>.
          </p>
        </li>
      </ol>
    </p>
  </answer>
  <solution permid="Lyh">
    <p permid="LcI">
      <ol label="a." permid="DTI">
        <li permid="iVy">
          <p permid="alG">
            Plot the data.
          </p>
        </li>

        <li permid="PcH">
          <p permid="GsP">
            Since the velocity is always positive,
            the definite integral that will give the exact distance traveled by the car on the interval <m>[0, 1.8]</m> is
            <me permid="caT">
              \int_0^{1.8} v(t) dt
            </me>.
          </p>
        </li>

        <li permid="vjQ">
          <p permid="mzY">
            The estimates of <m>\int_0^{1.8} v(t) dt</m> are
            <md permid="Iic">
              <mrow>L_3 \amp = 165.6 \text{ ft }  \amp  R_3 \amp = 105.6 \text{ ft }  \amp  T_3 \amp = 135.6 \text{ ft }</mrow>
            </md>.
            <m>R_3</m> is an underestimate of the distance traveled since <m>v(t)</m> is decreasing. <m>T_3</m> is an underestimate of the distance traveled since <m>v(t)</m> is concave down.
          </p>
        </li>

        <li permid="bqZ">
          <p permid="SHh">
            Another estimate of the distance traveled is
            <me permid="opl">
              M_3 = 143.4 \text{ ft }
            </me>.
            This is an overestimate since <m>v(t)</m> is concave down.
          </p>
        </li>

        <li permid="Hyi">
          <p permid="yOq">
            For Simpson's Rule, we see that
            <me permid="Uwu">
              S_6 = \frac{2}{3}M_3 + \frac{1}{3}T_3 = 140.8 \text{ ft }
            </me>.
          </p>
        </li>

        <li permid="nFr">
          <p permid="eVz">
            Simpson's rule gives the best approximation of the distance traveled since it is a weighted average of the midpoint and trapezoid rules and uses more information about the velocity than the other methods.
            The units on each of the estimates,
            including Simpson's Rule,
            are "feet", since ft/sec <m>\cdot</m> sec = ft.
            Thus,
            the best approximation we have generated is that <m>\int_0^{1.8} v(t) dt \approx 140.8 \text{ ft }</m>.
          </p>
        </li>
      </ol>
    </p>
  </solution>
</example>
  </subsection>

  <subsection permid="FGM">
    <title>Overall observations regarding <m>L_n</m>, <m>R_n</m>, <m>T_n</m>, <m>M_n</m>, and <m>S_{2n}</m>.</title>
    <p permid="gID">
      As we conclude our discussion of numerical approximation of definite integrals,
      it is important to summarize general trends in how the various rules over- or under-estimate the true value of a definite integral,
      and by how much.
      To revisit some past observations and see some new ones,
      we consider the following example.
    </p>

<example xml:id="act-5-6-3" permid="aAb">
  <statement>
    <p permid="gpn">
      Consider the functions <m>f(x) = 2-x^2</m>, <m>g(x) = 2-x^3</m>,
      and <m>h(x) = 2-x^4</m>, all on the interval <m>[0,1]</m>.
      For each of the questions that require a numerical answer in what follows,
      write your answer exactly in fraction form.

      <ol label="a." permid="JXp">
        <li permid="qey">
          <p permid="IRW">
            On the three sets of axes provided in <xref ref="F-5-6-Act3">Figure</xref>,
            sketch a graph of each function on the interval <m>[0,1]</m>,
            and compute <m>L_1</m> and <m>R_1</m> for each.
            What do you observe?
          </p>
        </li>

        <li permid="WlH">
          <p permid="oZf">
            Compute <m>M_1</m> for each function to approximate <m>\int_0^1 f(x) \,dx</m>,
            <m>\int_0^1 g(x) \,dx</m>,
            and <m>\int_0^1 h(x) \,dx</m>,
            respectively.
          </p>
        </li>

        <li permid="CsQ">
          <p permid="Vgo">
            Compute <m>T_1</m> for each of the three functions,
            and hence compute <m>S_2</m> for each of the three functions.
          </p>
        </li>

        <li permid="izZ">
          <p permid="Bnx">
            Evaluate each of the integrals <m>\int_0^1 f(x) \,dx</m>,
            <m>\int_0^1 g(x) \,dx</m>,
            and <m>\int_0^1 h(x) \,dx</m> exactly using the First FTC.
          </p>
        </li>

        <li permid="OHi">
          <p permid="huG">
            For each of the three functions <m>f</m>, <m>g</m>,
            and <m>h</m>,
            compare the results of <m>L_1</m>,
            <m>R_1</m>, <m>M_1</m>, <m>T_1</m>,
            and <m>S_2</m> to the true value of the corresponding definite integral.
            What patterns do you observe?
          </p>
        </li>
      </ol>
    </p>

    <figure xml:id="F-5-6-Act3" permid="Mww">
      <caption>Axes for plotting the functions in <xref ref="act-5-6-3">Example</xref>.</caption>
      <image width="100%" source="images/5_6_Act3" />
    </figure>
  </statement>
  <hint permid="luF">
    <p permid="Aie">
      <ol label="a." permid="dQg">
        <li permid="uOr">
          <p permid="NBP">
            For each estimate, just one function evaluation is needed.
          </p>
        </li>

        <li permid="aVA">
          <p permid="tIY">
            Use the midpoint rule with <m>n=1</m>.
          </p>
        </li>

        <li permid="HcJ">
          <p permid="ZQh">
            Remember that both the trapezoid and Simpson's rule can be executed using (weighted) averages of known values.
          </p>
        </li>

        <li permid="njS">
          <p permid="FXq">
            Find antiderivatives to evaluate the integrals exactly.
          </p>
        </li>

        <li permid="Trb">
          <p permid="mez">
            Think about trends in over- and under-estimates.
          </p>
        </li>
      </ol>
    </p>
  </hint>
  <answer permid="Fnw">
    <p permid="UaV">
      <ol label="a." permid="xIX">
        <li permid="zyk">
          <p permid="SlI">
            For <m>L_1</m> and <m>T_1</m>:
          </p>

          <table permid="ERX">
            <caption>Left and Trapezoid rules.</caption>
            <tabular top="minor" bottom="minor" permid="kZg">
              <row bottom="major">
                <cell><m>f</m></cell>
                <cell><m>g</m></cell>
                <cell><m>h</m></cell>
              </row>
              <row>
                <cell><m>L_1=2</m></cell>
                <cell><m>L_1=2</m></cell>
                <cell><m>L_1=2</m></cell>
              </row>
              <row>
                <cell><m>R_1=1</m></cell>
                <cell><m>R_1=1</m></cell>
                <cell><m>R_1=1</m></cell>
              </row>
            </tabular>

          </table>

          <p permid="ysR">
            The values of <m>L_1</m> and <m>R_1</m> are the same for all three.
          </p>
        </li>

        <li permid="fFt">
          <p permid="eAa">
            For the <m>M_1</m>,
          </p>

          <table permid="Rgp">
            <caption>Midpoint Rule.</caption>
            <tabular top="minor" bottom="minor" permid="xny">
              <row bottom="major">
                <cell><m>f</m></cell>
                <cell><m>g</m></cell>
                <cell><m>h</m></cell>
              </row>
              <row>
                <cell><m>M_1=\frac{7}{4}</m></cell>
                <cell><m>M_1=\frac{15}{8}</m></cell>
                <cell><m>M_1=\frac{31}{16}</m></cell>
              </row>
            </tabular>

          </table>

        </li>

        <li permid="LMC">
          <p permid="KHj">
            For <m>T_1</m> and <m>S_2</m>,
          </p>

          <table permid="duH">
            <caption>Trapezoid and Simpson's Rule.</caption>
            <tabular top="minor" bottom="minor" permid="JBQ">
              <row bottom="major">
                <cell><m>f</m></cell>
                <cell><m>g</m></cell>
                <cell><m>h</m></cell>
              </row>
              <row>
                <cell><m>T_1=\frac{3}{2}</m></cell>
                <cell><m>T_1=\frac{3}{2}</m></cell>
                <cell><m>T_1=\frac{3}{2}</m></cell>
              </row>
              <row>
                <cell><m>S_2=\frac{5}{3} \approx 1.6667</m></cell>
                <cell><m>S_2=\frac{7}{4}</m></cell>
                <cell><m>S_2=\frac{43}{24} \approx 1.79167</m></cell>
              </row>
            </tabular>

          </table>

        </li>

        <li permid="rTL">
          <p permid="qOs">
            <md permid="sDF">
              <mrow>\int_0^1 f(x) dx \amp = \frac{5}{3}   \amp   \int_0^1 g(x) dx \amp = \frac{7}{4}  \amp    \int_0^1 h(x) dx \amp = \frac{9}{5}</mrow>
            </md>
          </p>
        </li>

        <li permid="YaU">
          <p permid="WVB">
            Left endpoint rule results are overestimates;
            right endpoint rules are underestimates;
            midpoint rules are overestimates;
            trapezoid rules are underestimates.
            Simpson's rule is exact for both <m>f</m> and <m>g</m>,
            while a slight overestimate of <m>\int_0^1 h(x) dx</m>.
          </p>
        </li>
      </ol>
    </p>
  </answer>
  <solution permid="Zgn">
    <p permid="nTM">
      <ol label="a." permid="RBO">
        <li permid="Eid">
          <p permid="DcK">
            For the left and right endpoint rules, we see that
          </p>

          <table permid="pIZ">
            <caption>Left and Trapezoid rules.</caption>
            <tabular top="minor" bottom="minor" permid="VQi">
              <row bottom="major">
                <cell><m>f</m></cell>
                <cell><m>g</m></cell>
                <cell><m>h</m></cell>
              </row>
              <row>
                <cell><m>L_1=2</m></cell>
                <cell><m>L_1=2</m></cell>
                <cell><m>L_1=2</m></cell>
              </row>
              <row>
                <cell><m>R_1=1</m></cell>
                <cell><m>R_1=1</m></cell>
                <cell><m>R_1=1</m></cell>
              </row>
            </tabular>

          </table>

          <p permid="jjT">
            Thus,
            we observe that despite the fact the functions are all different,
            the values of <m>L_1</m> and <m>R_1</m> are the same for all three.
          </p>
        </li>

        <li permid="kpm">
          <p permid="Prc">
            For the midpoint rule, we find that
          </p>

          <table permid="BXr">
            <caption>Midpoint Rule.</caption>
            <tabular top="minor" bottom="minor" permid="ieA">
              <row bottom="major">
                <cell><m>f</m></cell>
                <cell><m>g</m></cell>
                <cell><m>h</m></cell>
              </row>
              <row>
                <cell><m>M_1=\frac{7}{4}</m></cell>
                <cell><m>M_1=\frac{15}{8}</m></cell>
                <cell><m>M_1=\frac{31}{16}</m></cell>
              </row>
            </tabular>

          </table>

        </li>

        <li permid="Qwv">
          <p permid="vyl">
            For the trapezoid rule and Simpson's rule,
          </p>

          <table permid="OlJ">
            <caption>Trapezoid and Simpson's Rule.</caption>
            <tabular top="minor" bottom="minor" permid="usS">
              <row bottom="major">
                <cell><m>f</m></cell>
                <cell><m>g</m></cell>
                <cell><m>h</m></cell>
              </row>
              <row>
                <cell><m>T_1=\frac{3}{2}</m></cell>
                <cell><m>T_1=\frac{3}{2}</m></cell>
                <cell><m>T_1=\frac{3}{2}</m></cell>
              </row>
              <row>
                <cell><m>S_2=\frac{5}{3} \approx 1.6667</m></cell>
                <cell><m>S_2=\frac{7}{4}</m></cell>
                <cell><m>S_2=\frac{43}{24} \approx 1.79167</m></cell>
              </row>
            </tabular>

          </table>

        </li>

        <li permid="wDE">
          <p permid="bFu">
            The exact values of the three definite integrals are
            <md permid="YKO">
              <mrow>\int_0^1 f(x) dx \amp = \frac{5}{3}   \amp   \int_0^1 g(x) dx \amp = \frac{7}{4}  \amp    \int_0^1 h(x) dx \amp = \frac{9}{5}</mrow>
              <mrow>\amp \approx 1.6667  \amp                          \amp = 1.75            \amp                          \amp = 1.8</mrow>
            </md>
          </p>
        </li>

        <li permid="cKN">
          <p permid="HMD">
            We observe that each of the left endpoint rule results are overestimates,
            each of the right endpoint rules are underestimates,
            each of the midpoint rules are overestimates,
            and each of the trapezoid rules are underestimates.
            These results hold because each of the three functions are both decreasing and concave down.
            For Simpson's rule,
            we see that the result is exact for both <m>f</m> and <m>g</m>,
            while Simpson's rule is a slight overestimate of <m>\int_0^1 h(x) dx</m>.
          </p>
        </li>
      </ol>
    </p>
  </solution>
</example>

    <p permid="MPM">
      The results seen in <xref ref="act-5-6-3">Example</xref> generalize nicely.
      For instance,
      if <m>f</m> is decreasing on <m>[a,b]</m>,
      <m>L_n</m> will over-estimate the exact value of <m>\int_a^b f(x) \,dx</m>,
      and if <m>f</m> is concave down on <m>[a,b]</m>,
      <m>M_n</m> will over-estimate the exact value of the integral.
      An excellent exercise is to write a collection of scenarios of possible function behavior,
      and then categorize whether each of <m>L_n</m>, <m>R_n</m>,
      <m>T_n</m>, and <m>M_n</m> is an over- or under-estimate.
    </p>

    <p permid="sWV">
      Finally, we make two important notes about Simpson's Rule.
      When T.<nbsp />Simpson first developed this rule,
      his idea was to replace the function <m>f</m> on a given interval with a quadratic function that shared three values with the function <m>f</m>.
      In so doing,
      he guaranteed that this new approximation rule would be exact for the definite integral of any quadratic polynomial.
      In one of the pleasant surprises of numerical analysis,
      it turns out that even though it was designed to be exact for quadratic polynomials, Simpson's Rule is exact for any cubic polynomial:
      that is, if we are interested in an integral such as <m>\int_2^5 (5x^3 - 2x^2 + 7x - 4)\, dx</m>,
      <m>S_{2n}</m> will always be exact,
      regardless of the value of <m>n</m>.
      This is just one more piece of evidence that shows how effective Simpson's Rule is as an approximation tool for estimating definite integrals.<fn>
      One reason that Simpson's Rule is so effective is that <m>S_{2n}</m> benefits from using <m>2n+1</m> points of data.
      Because it combines <m>M_n</m>,
      which uses <m>n</m> midpoints, and <m>T_n</m>,
      which uses the <m>n+1</m> endpoints of the chosen subintervals,
      <m>S_{2n}</m> takes advantage of the maximum amount of information we have when we know function values at the endpoints and midpoints of <m>n</m> subintervals.
      </fn></p>
  </subsection>

  <subsection permid="lNV">
    <title>Summary</title>
    <p permid="Zee">
      <ul permid="qxO">
        <li permid="Pay">
          <p permid="zRA">
            For a definite integral such as
            <m>\int_0^1 e^{-x^2} \, dx</m> when we cannot use the First Fundamental Theorem of Calculus because the integrand lacks an elementary algebraic antiderivative,
            we can estimate the integral's value by using a sequence of Riemann sum approximations.
            Typically, we start by computing <m>L_n</m>, <m>R_n</m>,
            and <m>M_n</m> for one or more chosen values of <m>n</m>.
          </p>
        </li>

        <li permid="vhH">
          <p permid="fYJ">
            The Trapezoid Rule, which estimates
            <m>\int_a^b f(x) \, dx</m> by using trapezoids,
            rather than rectangles,
            can also be viewed as the average of Left and Right Riemann sums.
            That is, <m>T_n = \frac{1}{2}(L_n + R_n)</m>.
          </p>
        </li>

        <li permid="boQ">
          <p permid="MfS">
            The Midpoint Rule is typically twice as accurate as the Trapezoid Rule,
            and the signs of the respective errors of these rules are opposites.
            Hence,
            by taking the weighted average <m>S_{2n} = \frac{2M_n + T_n}{3}</m>,
            we can build a much more accurate approximation to
            <m>\int_a^b f(x) \, dx</m> by using approximations we have already computed.
            The rule for <m>S_{2n}</m> is known as Simpson's Rule,
            which can also be developed by approximating a given continuous function with pieces of quadratic polynomials.
          </p>
        </li>
      </ul>
    </p>
  </subsection>

<exercises xmlns:xi="http://www.w3.org/2001/XInclude"> 

  <exercise xml:id="ez-5-6-WW1" permid="Uru">
    <title>Various methods for <m>e^x</m> numerically</title>
    <webwork source="Library/Michigan/Chap7Sec6/Q05.pg" />
  </exercise>
  <!--  WeBWorK exercise not compatible with PTX  -->
  <!--
  <exercise xml:id="ez-5-6-WW2">
    <webwork source="Library/Michigan/Chap7Sec5/Q23.pg" />
  </exercise>
  -->
  <exercise xml:id="ez-5-6-WW4" permid="AyD">
    <title>Comparison of methods for increasing concave down function</title>
    <webwork source="Library/Michigan/Chap7Sec5/Q13.pg" />
  </exercise>

  <exercise xml:id="ez-5-6-WW6" permid="gFM">
    <title>Comparing accuracy for two similar functions</title>
    <webwork source="Library/Michigan/Chap7Sec5/Q19.pg" />
  </exercise>

  <exercise xml:id="ez-5-6-WW8" permid="MMV">
    <title>Identifying and comparing methods</title>
    <webwork source="Library/Michigan/Chap7Sec5/Q01.pg" />
  </exercise>

  <exercise permid="sUe">
  <title> Comparing methods and identifying whether each is an overestimate or underestimate   </title>
    <statement>
      <p permid="Jbr">
        Consider the definite integral <m>\int_0^1 x \tan(x) \, dx</m>.

        <ol label="a." permid="Tmb">
          <li permid="ZLh">
            <p permid="BSr">
              Explain why this integral cannot be evaluated exactly by using either <m>u</m>-substitution or by integrating by parts.
            </p>
          </li>

          <li permid="FSq">
            <p permid="hZA">
              Using appropriate subintervals, compute <m>L_4</m>,
              <m>R_4</m>, <m>M_4</m>,
              <m>T_4</m>, and <m>S_8</m>.
            </p>
          </li>

          <li permid="lZz">
            <p permid="OgJ">
              Which of the approximations in (b) is an over-estimate to the true value of <m>\int_0^1 x \tan(x) \, dx</m>?
              Which is an under-estimate?
              How do you know?
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <answer permid="RwO">
      <p permid="QFQ">
        <ol label="a." permid="aQA">
          <li permid="SgI">
            <p permid="unS">
              <m>u</m>-substitution fails since there's not a composite function present;
              try showing that each of the choices of <m>u = x</m> and <m>dv = \tan(x) \, dx</m>,
              or <m>u = \tan(x)</m> and <m>dv = x \, dx</m>,
              fail to produce an integral that can be evaluated by parts.
            </p>
          </li>

          <li permid="ynR">
            <p permid="avb">
              <ul permid="uJr">
                <li permid="rOL">
                  <p permid="LVX">
                    <m>L_4 = 0.25892</m>
                  </p>
                </li>

                <li permid="XVU">
                  <p permid="GCk">
                    <m>R_4 = 0.64827</m>
                  </p>
                </li>

                <li permid="Edd">
                  <p permid="mJt">
                    <m>M_4 = 0.41550</m>
                  </p>
                </li>

                <li permid="kkm">
                  <p permid="SQC">
                    <m>T_4 = \frac{L_4 + R_4}{2} = 0.45360</m>
                  </p>
                </li>

                <li permid="Qrv">
                  <p permid="yXL">
                    <m>S_8 = \frac{2M_4 + T_4}{3} = 0.42820</m>
                  </p>
                </li>
              </ul>
            </p>
          </li>

          <li permid="eva">
            <p permid="feU">
              <m>L_4</m> and <m>M_4</m> are underestimates;
              <m>R_4</m> and <m>M_4</m> are overestimates.
            </p>
          </li>
        </ol>
      </p>
    </answer>
    <solution permid="lpF">
      <p permid="Ykp">
        <ol label="a." permid="CnQ">
          <li permid="KCj">
            <p permid="Lmd">
              We can't use <m>u</m>-substitution since there's not a function-derivative pair present
              (nor even a composite function).
              To show that integration by parts doesn't work is more complicated,
              but comes down to the fact that if we use the natural choice of <m>u = x</m> and <m>dv = \tan(x) \, dx</m>,
              to do so requires us to evaluate the integral <m>\int \ln(\sec(x)) \, dx</m>,
              which appears not to have an elementary antiderivative.
              If we try instead <m>u = \tan(x)</m> and <m>dv = x \, dx</m>,
              then we have to evaluate the integral
              <m>\int x^2 \cdot \sec^2(x) \, dx</m> which is more complicated than the integral we started with and would seem to send us back where we started if we attempt integration by parts.
            </p>
          </li>

          <li permid="qJs">
            <p permid="rtm">
              We use computational technology to generate the following estimates,
              which are reported to <m>5</m> decimal places of accuracy:

              <ul permid="WgH">
                <li permid="wyE">
                  <p permid="sdg">
                    <m>L_4 = 0.25892</m>
                  </p>
                </li>

                <li permid="cFN">
                  <p permid="XAv">
                    <m>R_4 = 0.64827</m>
                  </p>
                </li>

                <li permid="IMW">
                  <p permid="DHE">
                    <m>M_4 = 0.41550</m>
                  </p>
                </li>

                <li permid="oUf">
                  <p permid="jON">
                    <m>T_4 = \frac{L_4 + R_4}{2} = 0.45360</m>
                  </p>
                </li>

                <li permid="Vbo">
                  <p permid="PVW">
                    <m>S_8 = \frac{2M_4 + T_4}{3} = 0.42820</m>
                  </p>
                </li>
              </ul>
            </p>
          </li>

          <li permid="WQB">
            <p permid="wdf">
              From the values of these estimates or from the graph of <m>f(x) = x\tan(x)</m>,
              we can observe that <m>f</m> is always increasing and concave up on the interval.
              Thus, <m>L_4</m> and <m>M_4</m> are underestimates while <m>R_4</m> and <m>M_4</m> are overestimates.
            </p>
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

  <exercise permid="Zbn">
  <title> Relation of function properties to approximation methods  </title>
    <statement>
      <p permid="piA">
        For an unknown function <m>f(x)</m>,
        the following information is known.

        <ul permid="ztk">
          <li permid="Bix">
            <p permid="cko">
              <m>f</m> is continuous on <m>[3,6]</m>;
            </p>
          </li>

          <li permid="hpG">
            <p permid="Irx">
              <m>f</m> is either always increasing or always decreasing on <m>[3,6]</m>;
            </p>
          </li>

          <li permid="NwP">
            <p permid="oyG">
              <m>f</m> has the same concavity throughout the interval <m>[3,6]</m>;
            </p>
          </li>

          <li permid="tDY">
            <p permid="UFP">
              As approximations to <m>\int_3^6 f(x) \, dx</m>,
              <m>L_4 = 7.23</m>, <m>R_4 = 6.75</m>, and <m>M_4 = 7.05</m>.
            </p>
          </li>
        </ul>

        <ol label="a." permid="fAt">
          <li permid="CXK">
            <p permid="AMY">
              Is <m>f</m> increasing or decreasing on <m>[3,6]</m>?
              What data tells you?
            </p>
          </li>

          <li permid="jeT">
            <p permid="gUh">
              Is <m>f</m> concave up or concave down on <m>[3,6]</m>?
              Why?
            </p>
          </li>

          <li permid="Pmc">
            <p permid="Nbq">
              Determine the best possible estimate you can for <m>\int_3^6 f(x) \, dx</m>,
              based on the given information.
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <answer permid="dLg">
      <p permid="wMZ">
        <ol label="a." permid="GXJ">
          <li permid="vtl">
            <p permid="tiz">
              Decreasing.
            </p>
          </li>

          <li permid="bAu">
            <p permid="ZpI">
              Concave down.
            </p>
          </li>

          <li permid="HHD">
            <p permid="FwR">
              <m>\int_3^6 f(x) \approx 7.03</m>.
            </p>
          </li>
        </ol>
      </p>
    </answer>
    <solution permid="xDX">
      <p permid="Ery">
        <ol label="a." permid="iuZ">
          <li permid="nOM">
            <p permid="lEa">
              Because <m>L_4 = 7.23 \gt 6.75 = R_4</m> and we know the function is always increasing or always decreasing,
              for the left endpoint rule to give a value greater than the right endpoint rule,
              <m>f</m> must be always decreasing.
            </p>
          </li>

          <li permid="TVV">
            <p permid="RLj">
              From the given data, we know that
              <me permid="hEb">
                T_4 = \frac{L_4 + R_4}{2} = \frac{7.23 + 6.75}{2} = 6.99
              </me>.
              Since <m>M_4 = 7.05</m>, it follows that
              <me permid="NLk">
                R_4 \lt T_4 \lt M_4 \lt L_4
              </me>.
              In particular,
              we know that the function is not only always decreasing on the interval,
              but it also concave down.
              Because the concavity is constant,
              it follows that if the trapezoid rule under-estimates the true value,
              then the midpoint rule must over-estimate the true value
              (or vice-versa).
              Since <m>T_4 \lt M_4</m>, this means that
              <me permid="tSt">
                T_4 \lt \int_3^6 f(x) \, dx \lt M_4
              </me>
              and that <m>f</m> must be concave down on the interval.
            </p>
          </li>

          <li permid="Ade">
            <p permid="xSs">
              We use Simpson's Rule to determine the best possible estimate for the definite integral.
              That is,
              <md permid="ZZC">
                <mrow>\int_3^6 f(x) \, dx &amp;\approx S_8</mrow>
                <mrow>&amp;= \frac{2M_4 + T_4}{3}</mrow>
                <mrow>&amp;= \frac{2 \cdot 7.05 + 6.99}{3}</mrow>
                <mrow>&amp;=7.03</mrow>
              </md>.
            </p>
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

  <exercise permid="Fiw">
  <title> Modeling flow rate using an integral and approximating solution </title>
    <statement>
      <p permid="VpJ">
        The rate at which water flows through Table Rock Dam on the White River in Branson, MO, is measured in thousands of cubic feet per second (TCFS).
        As engineers open the floodgates,
        flow rates are recorded according to the following chart.
      </p>

      <table permid="PAx">
        <caption>Water flow data.</caption>
        <tabular top="minor" bottom="minor" permid="vHG">
          <row>
            <cell>seconds, <m>t</m></cell>
            <cell><m>0</m></cell>
            <cell><m>10</m></cell>
            <cell><m>20</m></cell>
            <cell><m>30</m></cell>
            <cell><m>40</m></cell>
            <cell><m>50</m></cell>
            <cell><m>60</m></cell>
          </row>
          <row>
            <cell>flow in TCFS, <m>r(t)</m></cell>
            <cell><m>2000</m></cell>
            <cell><m>2100</m></cell>
            <cell><m>2400</m></cell>
            <cell><m>3000</m></cell>
            <cell><m>3900</m></cell>
            <cell><m>5100</m></cell>
            <cell><m>6500</m></cell>
          </row>
        </tabular>

      </table>

      <p permid="BwS">
        <ol label="a." permid="LHC">
          <li permid="gkn">
            <p permid="dZB">
              What definite integral measures the total volume of water to flow through the dam in the 60 second time period provided by the table above?
            </p>
          </li>

          <li permid="Mrw">
            <p permid="KgK">
              Use the given data to calculate <m>M_n</m> for the largest possible value of <m>n</m> to approximate the integral you stated in (a).
              Do you think <m>M_n</m> over- or under-estimates the exact value of the integral?
              Why?
            </p>
          </li>

          <li permid="syF">
            <p permid="qnT">
              Approximate the integral stated in (a) by calculating <m>S_n</m> for the largest possible value of <m>n</m>,
              based on the given data.
            </p>
          </li>

          <li permid="YFO">
            <p permid="Wvc">
              Compute <m>\frac{1}{60} S_n</m> and <m>\frac{2000+2100+2400+3000+3900+5100+6500}{7}</m>.
              What quantity do both of these values estimate?
              Which is a more accurate approximation?
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <answer permid="pZy">
      <p permid="cUi">
        <ol label="a." permid="neS">
          <li permid="EMX">
            <p permid="CCl">
              <m>
              \int_0^{60} r(t) \, dt
              </m>.
            </p>
          </li>

          <li permid="kUg">
            <p permid="iJu">
              <m>
              \int_0^{60} r(t) \, dt \gt M_3 = 204000</m>.
            </p>
          </li>

          <li permid="Rbp">
            <p permid="OQD">
              <m>
              \int_0^{60} r(t) \, dt \approx S_6 = \frac{619000}{3} \approx 206333.33</m>.
            </p>
          </li>

          <li permid="xiy">
            <p permid="uXM">
              <m>
              \frac{1}{60} S_6 \approx 3438.89
              </m>; 
              <m>
              \frac{2000+2100+2400+3000+3900+5100+6500}{7} = \frac{25000}{7} \approx 3571.43
              </m>.
              each estimates the average rate at which water flows through the dam on <m>[0,60]</m>,
              and the first is more accurate.
            </p>
          </li>
        </ol>
      </p>
    </answer>
    <solution permid="JSp">
      <p permid="kyH">
        <ol label="a." permid="OCi">
          <li permid="dpH">
            <p permid="beV">
              Because <m>r(t)</m> is measured in thousands of cubic feet per second and
              <m>\triangle t</m> is measured in seconds, the definite integral
              <me permid="GgL">
                \int_0^{60} r(t) \, dt
              </me>
              measures the total amount of water
              (in thousands of cubic feet)
              that flow through the dam in 60 seconds.
            </p>
          </li>

          <li permid="JwQ">
            <p permid="Hme">
              With <m>7</m> function values and thus <m>6</m> subintervals as the maximum number of intervals we can use,
              we can compute <m>M_3</m> since we need to use every other data point to evaluate the function.
              Doing so,
              <md permid="mnU">
                <mrow>\int_0^{60} r(t) \, dt &amp;\approx M_3</mrow>
                <mrow>&amp;= r(10) \cdot 20 + r(30) \cdot 20 + r(50) \cdot 20</mrow>
                <mrow>&amp;= (2100 + 3000 + 5100) \cdot 20</mrow>
                <mrow>&amp;= 204000</mrow>
              </md>.
              Thus, approximately <m>204 000 000</m> cubic feet of water pass through the dam on the interval <m>0 \le t \le 60</m>.
            </p>

            <p permid="ntn">
              We observe that <m>r</m> appears to be increasing at an increasing rate on <m>0 \le t \le 60</m>.
              In particular,
              the data suggests that <m>r</m> is concave up on the interval.
              As such, the trapezoid rule will over-estimate the true value of the definite integral and the midpoint rule will under-estimate the value.
              Thus,
              <me permid="Svd">
                \int_0^{60} r(t) \, dt \gt M_3 = 204000
              </me>.
            </p>
          </li>

          <li permid="pDZ">
            <p permid="TAw">
              In order to estimate the integral using <m>S_6</m>,
              we need to know the value of <m>T_3</m> along with <m>M_3</m>.
              To find <m>T_3</m>, we compute <m>L_3</m> and <m>R_3</m>.
              First
              <me permid="yCm">
                L_3 = r(0) \cdot 20 + r(20) \cdot 20 + r(40) \cdot 20 = (2000 + 2400 + 3900) \cdot 20 = 166000
              </me>.
              Similarly,
              <me permid="eJv">
                R_3 = r(20) \cdot 20 + r(40) \cdot 20 + r(60) \cdot 20 = (2400 + 3900 + 6500) \cdot 20 = 256000
              </me>.
              Thus,
              <me permid="KQE">
                T_3 = \frac{L_3 + R_3}{2} = \frac{166000 + 256000}{2} = 211000
              </me>.
              Finally, we now have the information needed to compute <m>S_6</m>.
              We thus find that
              <me permid="qXN">
                \int_0^{60} r(t) \, dt \approx S_6 = \frac{2M_3 + T_3}{3} = \frac{2 \cdot 204000 + 211000}{3} = \frac{619000}{3} \approx 206333.33
              </me>.
            </p>
          </li>

          <li permid="VLi">
            <p permid="zHF">
              First,
              <me permid="XeW">
                \frac{1}{60} S_6 = \frac{206333.33}{60} = \frac{30950}{9} \approx 3438.89
              </me>.
              This is one estimate for the average value of <m>r</m> on <m>[0,60]</m> since
              <me permid="Dmf">
                r_{\operatorname{AVG} [0,60]} = \frac{1}{60-0} \int_0^{60} r(t) \, dt
              </me>,
              and <m>\int_0^{60} r(t) \, dt \approx S_6</m>.
              Thus, on average,
              water is flowing through the dam at a rate of <m>3438.89</m> thousand cubic feet per second.
            </p>

            <p permid="fOO">
              Next,
              <me permid="jto">
                \frac{2000+2100+2400+3000+3900+5100+6500}{7} = \frac{25000}{7} \approx 3571.43
              </me>
              is the average of the <m>7</m> known values of <m>r(t)</m> on the interval <m>[0,60]</m>,
              and thus is one estiamte of the average value of <m>r</m>.
              This average treats all of them equally,
              as opposed to <m>S_6</m> which counts midpoints more than endpoints and is developed in such a way to remove some of the error inherent in using simple estimates like <m>L_6</m> and <m>R_6</m>.
              This simple average of <m>7</m> rate values is analogous to using a left or right Riemann sum,
              and thus we expect that the estimate of the average value of <m>r</m> that comes from <m>S_6</m> is more accurate for computing the average rate at which water flows through the dam.
            </p>
          </li>
        </ol>
      </p>
    </solution>
  </exercise>

 </exercises>
</section>

